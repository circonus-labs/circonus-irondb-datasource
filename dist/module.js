/*! For license information please see module.js.LICENSE.txt */
define(["lodash","app/plugins/sdk","app/core/app_events"],(function(t,e,n){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=96)}([function(e,n){e.exports=t},function(t,e,n){"use strict";t.exports=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return t}},function(t,e,n){"use strict";var r=n(27)();t.exports=function(t){return t!==r&&null!==t}},function(t,e,n){"use strict";var r=n(28),a=Math.max;t.exports=function(t){return a(0,r(t))}},function(t,e,n){},function(t,e,n){"use strict";var r=n(17),a=n(42),o=n(14),i=n(12),u=n(46);(t.exports=function(t,e){var n,a,s,c,l;return arguments.length<2||"string"!=typeof t?(c=e,e=t,t=null):c=arguments[2],r(t)?(n=u.call(t,"c"),a=u.call(t,"e"),s=u.call(t,"w")):(n=s=!0,a=!1),l={value:e,configurable:n,enumerable:a,writable:s},c?o(i(c),l):l}).gs=function(t,e,n){var s,c,l,f;return"string"!=typeof t?(l=n,n=e,e=t,t=null):l=arguments[3],r(e)?a(e)?r(n)?a(n)||(l=n,n=void 0):n=void 0:(l=e,e=n=void 0):e=void 0,r(t)?(s=u.call(t,"c"),c=u.call(t,"e")):(s=!0,c=!1),f={get:e,set:n,configurable:s,enumerable:c},l?o(i(l),f):f}},function(t,e,n){"use strict";var r=n(2);t.exports=function(t){if(!r(t))throw new TypeError("Cannot use null or undefined");return t}},function(t,e,n){"use strict";t.exports=n(33)("forEach")},function(t,e,n){"use strict";t.exports=n(56)()?globalThis:n(57)},function(t,e,n){"use strict";t.exports=n(52)()?Array.from:n(53)},function(t,e,n){"use strict";var r=n(70),a=n(3),o=n(6),i=Array.prototype.indexOf,u=Object.prototype.hasOwnProperty,s=Math.abs,c=Math.floor;t.exports=function(t){var e,n,l,f;if(!r(t))return i.apply(this,arguments);for(n=a(o(this).length),l=arguments[1],e=l=isNaN(l)?0:l>=0?c(l):a(this.length)-c(s(l));e<n;++e)if(u.call(this,e)&&(f=this[e],r(f)))return e;return-1}},function(t,e,n){"use strict";(function(e,n){var r=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return t},a=function(t){var e,n,a=document.createTextNode(""),o=0;return new t((function(){var t;if(e)n&&(e=n.concat(e));else{if(!n)return;e=n}if(n=e,e=null,"function"==typeof n)return t=n,n=null,void t();for(a.data=o=++o%2;n;)t=n.shift(),n.length||(n=null),t()})).observe(a,{characterData:!0}),function(t){r(t),e?"function"==typeof e?e=[e,t]:e.push(t):(e=t,a.data=o=++o%2)}};t.exports=function(){if("object"==typeof e&&e&&"function"==typeof e.nextTick)return e.nextTick;if("function"==typeof queueMicrotask)return function(t){queueMicrotask(r(t))};if("object"==typeof document&&document){if("function"==typeof MutationObserver)return a(MutationObserver);if("function"==typeof WebKitMutationObserver)return a(WebKitMutationObserver)}return"function"==typeof n?function(t){n(r(t))}:"function"==typeof setTimeout||"object"==typeof setTimeout?function(t){setTimeout(r(t),0)}:null}()}).call(this,n(20),n(76).setImmediate)},function(t,e,n){"use strict";var r=n(2),a=Array.prototype.forEach,o=Object.create,i=function(t,e){var n;for(n in t)e[n]=t[n]};t.exports=function(t){var e=o(null);return a.call(arguments,(function(t){r(t)&&i(Object(t),e)})),e}},function(t,e,n){"use strict";var r=n(3);t.exports=function(t,e,n){var a;return isNaN(t)?(a=e)>=0?n&&a?a-1:a:1:!1!==t&&r(t)}},function(t,e,n){"use strict";t.exports=n(36)()?Object.assign:n(37)},function(t,e,n){"use strict";var r,a,o,i,u,s=n(3),c=function(t,e){return e};try{Object.defineProperty(c,"length",{configurable:!0,writable:!1,enumerable:!1,value:1})}catch(t){}1===c.length?(r={configurable:!0,writable:!1,enumerable:!1},a=Object.defineProperty,t.exports=function(t,e){return e=s(e),t.length===e?t:(r.value=e,a(t,"length",r))}):(i=n(16),u=[],o=function(t){var e,n=0;if(u[t])return u[t];for(e=[];t--;)e.push("a"+(++n).toString(36));return new Function("fn","return function ("+e.join(", ")+") { return fn.apply(this, arguments); };")},t.exports=function(t,e){var n;if(e=s(e),t.length===e)return t;n=o(e)(t);try{i(n,t)}catch(t){}return n})},function(t,e,n){"use strict";var r=n(6),a=Object.defineProperty,o=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols;t.exports=function(t,e){var n,s=Object(r(e));if(t=Object(r(t)),i(s).forEach((function(r){try{a(t,r,o(e,r))}catch(t){n=t}})),"function"==typeof u&&u(s).forEach((function(r){try{a(t,r,o(e,r))}catch(t){n=t}})),void 0!==n)throw n;return t}},function(t,e,n){"use strict";t.exports=function(t){return null!=t}},function(t,e,n){"use strict";var r=n(59);t.exports=function(t){if(!r(t))throw new TypeError(t+" is not a symbol");return t}},function(t,e,n){"use strict";var r=n(1),a=n(7),o=Function.prototype.call;t.exports=function(t,e){var n={},i=arguments[2];return r(e),a(t,(function(t,r,a,u){n[r]=o.call(e,i,t,r,a,u)})),n}},function(t,e){var n,r,a=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function u(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(t){r=i}}();var s,c=[],l=!1,f=-1;function p(){l&&s&&(l=!1,s.length?c=s.concat(c):f=-1,c.length&&d())}function d(){if(!l){var t=u(p);l=!0;for(var e=c.length;e;){for(s=c,c=[];++f<e;)s&&s[f].run();f=-1,e=c.length}s=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function g(){}a.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new h(t,e)),1!==c.length||l||u(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=g,a.addListener=g,a.once=g,a.off=g,a.removeListener=g,a.removeAllListeners=g,a.emit=g,a.prependListener=g,a.prependOnceListener=g,a.listeners=function(t){return[]},a.binding=function(t){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(t){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";t.exports=function(t){return"function"==typeof t}},function(t,e){function n(t){return!!t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof t.then}t.exports=n,t.exports.default=n},function(t,e,n){"use strict";var r=n(12),a=n(13),o=n(32);t.exports=function(t){var e,i=r(arguments[1]);return i.normalizer||0!==(e=i.length=a(i.length,t.length,i.async))&&(i.primitive?!1===e?i.normalizer=n(67):e>1&&(i.normalizer=n(68)(e)):i.normalizer=!1===e?n(69)():1===e?n(73)():n(74)(e)),i.async&&n(75),i.promise&&n(78),i.dispose&&n(84),i.maxAge&&n(85),i.max&&n(88),i.refCounter&&n(90),o(t,i)}},function(t,n){t.exports=e},function(t,e){t.exports=n},function(t,e,n){"use strict";t.exports=function(){}},function(t,e,n){"use strict";var r=n(29),a=Math.abs,o=Math.floor;t.exports=function(t){return isNaN(t)?0:0!==(t=Number(t))&&isFinite(t)?r(t)*o(a(t)):t}},function(t,e,n){"use strict";t.exports=n(30)()?Math.sign:n(31)},function(t,e,n){"use strict";t.exports=function(){var t=Math.sign;return"function"==typeof t&&(1===t(10)&&-1===t(-20))}},function(t,e,n){"use strict";t.exports=function(t){return t=Number(t),isNaN(t)||0===t?t:t>0?1:-1}},function(t,e,n){"use strict";var r=n(1),a=n(7),o=n(4),i=n(34),u=n(13);t.exports=function t(e){var n,s,c;if(r(e),(n=Object(arguments[1])).async&&n.promise)throw new Error("Options 'async' and 'promise' cannot be used together");return hasOwnProperty.call(e,"__memoized__")&&!n.force?e:(s=u(n.length,e.length,n.async&&o.async),c=i(e,s,n),a(o,(function(t,e){n[e]&&t(n[e],c,n)})),t.__profiler__&&t.__profiler__(c),c.updateEnv(),c.memoized)}},function(t,e,n){"use strict";var r=n(1),a=n(6),o=Function.prototype.bind,i=Function.prototype.call,u=Object.keys,s=Object.prototype.propertyIsEnumerable;t.exports=function(t,e){return function(n,c){var l,f=arguments[2],p=arguments[3];return n=Object(a(n)),r(c),l=u(n),p&&l.sort("function"==typeof p?o.call(p,n):void 0),"function"!=typeof t&&(t=l[t]),i.call(t,l,(function(t,r){return s.call(n,t)?i.call(c,f,n[t],t,n,r):e}))}}},function(t,e,n){"use strict";var r=n(35),a=n(15),o=n(5),i=n(49).methods,u=n(50),s=n(66),c=Function.prototype.apply,l=Function.prototype.call,f=Object.create,p=Object.defineProperties,d=i.on,h=i.emit;t.exports=function(t,e,n){var i,g,m,y,v,b,T,w,S,_,A,E,x,O,C,j=f(null);return g=!1!==e?e:isNaN(t.length)?1:t.length,n.normalizer&&(_=s(n.normalizer),m=_.get,y=_.set,v=_.delete,b=_.clear),null!=n.resolvers&&(C=u(n.resolvers)),O=m?a((function(e){var n,a,o=arguments;if(C&&(o=C(o)),null!==(n=m(o))&&hasOwnProperty.call(j,n))return A&&i.emit("get",n,o,this),j[n];if(a=1===o.length?l.call(t,this,o[0]):c.call(t,this,o),null===n){if(null!==(n=m(o)))throw r("Circular invocation","CIRCULAR_INVOCATION");n=y(o)}else if(hasOwnProperty.call(j,n))throw r("Circular invocation","CIRCULAR_INVOCATION");return j[n]=a,E&&i.emit("set",n,null,a),a}),g):0===e?function(){var e;if(hasOwnProperty.call(j,"data"))return A&&i.emit("get","data",arguments,this),j.data;if(e=arguments.length?c.call(t,this,arguments):l.call(t,this),hasOwnProperty.call(j,"data"))throw r("Circular invocation","CIRCULAR_INVOCATION");return j.data=e,E&&i.emit("set","data",null,e),e}:function(e){var n,a,o=arguments;if(C&&(o=C(arguments)),a=String(o[0]),hasOwnProperty.call(j,a))return A&&i.emit("get",a,o,this),j[a];if(n=1===o.length?l.call(t,this,o[0]):c.call(t,this,o),hasOwnProperty.call(j,a))throw r("Circular invocation","CIRCULAR_INVOCATION");return j[a]=n,E&&i.emit("set",a,null,n),n},i={original:t,memoized:O,profileName:n.profileName,get:function(t){return C&&(t=C(t)),m?m(t):String(t[0])},has:function(t){return hasOwnProperty.call(j,t)},delete:function(t){var e;hasOwnProperty.call(j,t)&&(v&&v(t),e=j[t],delete j[t],x&&i.emit("delete",t,e))},clear:function(){var t=j;b&&b(),j=f(null),i.emit("clear",t)},on:function(t,e){return"get"===t?A=!0:"set"===t?E=!0:"delete"===t&&(x=!0),d.call(this,t,e)},emit:h,updateEnv:function(){t=i.original}},T=m?a((function(t){var e,n=arguments;C&&(n=C(n)),null!==(e=m(n))&&i.delete(e)}),g):0===e?function(){return i.delete("data")}:function(t){return C&&(t=C(arguments)[0]),i.delete(t)},w=a((function(){var t,n=arguments;return 0===e?j.data:(C&&(n=C(n)),t=m?m(n):String(n[0]),j[t])})),S=a((function(){var t,n=arguments;return 0===e?i.has("data"):(C&&(n=C(n)),null!==(t=m?m(n):String(n[0]))&&i.has(t))})),p(O,{__memoized__:o(!0),delete:o(T),clear:o(i.clear),_get:o(w),_has:o(S)}),i}},function(t,e,n){"use strict";var r=n(14),a=n(41),o=n(2),i=Error.captureStackTrace;t.exports=function(e){var n=new Error(e),u=arguments[1],s=arguments[2];return o(s)||a(u)&&(s=u,u=null),o(s)&&r(n,s),o(u)&&(n.code=u),i&&i(n,t.exports),n}},function(t,e,n){"use strict";t.exports=function(){var t,e=Object.assign;return"function"==typeof e&&(e(t={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}},function(t,e,n){"use strict";var r=n(38),a=n(6),o=Math.max;t.exports=function(t,e){var n,i,u,s=o(arguments.length,2);for(t=Object(a(t)),u=function(r){try{t[r]=e[r]}catch(t){n||(n=t)}},i=1;i<s;++i)r(e=arguments[i]).forEach(u);if(void 0!==n)throw n;return t}},function(t,e,n){"use strict";t.exports=n(39)()?Object.keys:n(40)},function(t,e,n){"use strict";t.exports=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}},function(t,e,n){"use strict";var r=n(2),a=Object.keys;t.exports=function(t){return a(r(t)?Object(t):t)}},function(t,e,n){"use strict";var r=n(2),a={function:!0,object:!0};t.exports=function(t){return r(t)&&a[typeof t]||!1}},function(t,e,n){"use strict";var r=n(43),a=/^\s*class[\s{/}]/,o=Function.prototype.toString;t.exports=function(t){return!!r(t)&&!a.test(o.call(t))}},function(t,e,n){"use strict";var r=n(44);t.exports=function(t){if("function"!=typeof t)return!1;if(!hasOwnProperty.call(t,"length"))return!1;try{if("number"!=typeof t.length)return!1;if("function"!=typeof t.call)return!1;if("function"!=typeof t.apply)return!1}catch(t){return!1}return!r(t)}},function(t,e,n){"use strict";var r=n(45);t.exports=function(t){if(!r(t))return!1;try{return!!t.constructor&&t.constructor.prototype===t}catch(t){return!1}}},function(t,e,n){"use strict";var r=n(17),a={object:!0,function:!0,undefined:!0};t.exports=function(t){return!!r(t)&&hasOwnProperty.call(a,typeof t)}},function(t,e,n){"use strict";t.exports=n(47)()?String.prototype.contains:n(48)},function(t,e,n){"use strict";var r="razdwatrzy";t.exports=function(){return"function"==typeof r.contains&&(!0===r.contains("dwa")&&!1===r.contains("foo"))}},function(t,e,n){"use strict";var r=String.prototype.indexOf;t.exports=function(t){return r.call(this,t,arguments[1])>-1}},function(t,e,n){"use strict";var r,a,o,i,u,s,c,l=n(5),f=n(1),p=Function.prototype.apply,d=Function.prototype.call,h=Object.create,g=Object.defineProperty,m=Object.defineProperties,y=Object.prototype.hasOwnProperty,v={configurable:!0,enumerable:!1,writable:!0};a=function(t,e){var n,a;return f(e),a=this,r.call(this,t,n=function(){o.call(a,t,n),p.call(e,this,arguments)}),n.__eeOnceListener__=e,this},u={on:r=function(t,e){var n;return f(e),y.call(this,"__ee__")?n=this.__ee__:(n=v.value=h(null),g(this,"__ee__",v),v.value=null),n[t]?"object"==typeof n[t]?n[t].push(e):n[t]=[n[t],e]:n[t]=e,this},once:a,off:o=function(t,e){var n,r,a,o;if(f(e),!y.call(this,"__ee__"))return this;if(!(n=this.__ee__)[t])return this;if("object"==typeof(r=n[t]))for(o=0;a=r[o];++o)a!==e&&a.__eeOnceListener__!==e||(2===r.length?n[t]=r[o?0:1]:r.splice(o,1));else r!==e&&r.__eeOnceListener__!==e||delete n[t];return this},emit:i=function(t){var e,n,r,a,o;if(y.call(this,"__ee__")&&(a=this.__ee__[t]))if("object"==typeof a){for(n=arguments.length,o=new Array(n-1),e=1;e<n;++e)o[e-1]=arguments[e];for(a=a.slice(),e=0;r=a[e];++e)p.call(r,this,o)}else switch(arguments.length){case 1:d.call(a,this);break;case 2:d.call(a,this,arguments[1]);break;case 3:d.call(a,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),e=1;e<n;++e)o[e-1]=arguments[e];p.call(a,this,o)}}},s={on:l(r),once:l(a),off:l(o),emit:l(i)},c=m({},s),t.exports=e=function(t){return null==t?h(c):m(Object(t),s)},e.methods=u},function(t,e,n){"use strict";var r,a=n(51),o=n(2),i=n(1),u=Array.prototype.slice;r=function(t){return this.map((function(e,n){return e?e(t[n]):t[n]})).concat(u.call(t,this.length))},t.exports=function(t){return(t=a(t)).forEach((function(t){o(t)&&i(t)})),r.bind(t)}},function(t,e,n){"use strict";var r=n(9),a=Array.isArray;t.exports=function(t){return a(t)?t:r(t)}},function(t,e,n){"use strict";t.exports=function(){var t,e,n=Array.from;return"function"==typeof n&&(e=n(t=["raz","dwa"]),Boolean(e&&e!==t&&"dwa"===e[1]))}},function(t,e,n){"use strict";var r=n(54).iterator,a=n(63),o=n(64),i=n(3),u=n(1),s=n(6),c=n(2),l=n(65),f=Array.isArray,p=Function.prototype.call,d={configurable:!0,enumerable:!0,writable:!0,value:null},h=Object.defineProperty;t.exports=function(t){var e,n,g,m,y,v,b,T,w,S,_=arguments[1],A=arguments[2];if(t=Object(s(t)),c(_)&&u(_),this&&this!==Array&&o(this))e=this;else{if(!_){if(a(t))return 1!==(y=t.length)?Array.apply(null,t):((m=new Array(1))[0]=t[0],m);if(f(t)){for(m=new Array(y=t.length),n=0;n<y;++n)m[n]=t[n];return m}}m=[]}if(!f(t))if(void 0!==(w=t[r])){for(b=u(w).call(t),e&&(m=new e),T=b.next(),n=0;!T.done;)S=_?p.call(_,A,T.value,n):T.value,e?(d.value=S,h(m,n,d)):m[n]=S,T=b.next(),++n;y=n}else if(l(t)){for(y=t.length,e&&(m=new e),n=0,g=0;n<y;++n)S=t[n],n+1<y&&(v=S.charCodeAt(0))>=55296&&v<=56319&&(S+=t[++n]),S=_?p.call(_,A,S,g):S,e?(d.value=S,h(m,g,d)):m[g]=S,++g;y=g}if(void 0===y)for(y=i(t.length),e&&(m=new e(y)),n=0;n<y;++n)S=_?p.call(_,A,t[n],n):t[n],e?(d.value=S,h(m,n,d)):m[n]=S;return e&&(d.value=null,m.length=y),m}},function(t,e,n){"use strict";t.exports=n(55)()?n(8).Symbol:n(58)},function(t,e,n){"use strict";var r=n(8),a={object:!0,symbol:!0};t.exports=function(){var t,e=r.Symbol;if("function"!=typeof e)return!1;t=e("test symbol");try{String(t)}catch(t){return!1}return!!a[typeof e.iterator]&&(!!a[typeof e.toPrimitive]&&!!a[typeof e.toStringTag])}},function(t,e,n){"use strict";t.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(t,e){var n=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};t.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(t){return n()}try{return __global__||n()}finally{delete Object.prototype.__global__}}()},function(t,e,n){"use strict";var r,a,o,i=n(5),u=n(18),s=n(8).Symbol,c=n(60),l=n(61),f=n(62),p=Object.create,d=Object.defineProperties,h=Object.defineProperty;if("function"==typeof s)try{String(s()),o=!0}catch(t){}else s=null;a=function(t){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return r(t)},t.exports=r=function t(e){var n;if(this instanceof t)throw new TypeError("Symbol is not a constructor");return o?s(e):(n=p(a.prototype),e=void 0===e?"":String(e),d(n,{__description__:i("",e),__name__:i("",c(e))}))},l(r),f(r),d(a.prototype,{constructor:i(r),toString:i("",(function(){return this.__name__}))}),d(r.prototype,{toString:i((function(){return"Symbol ("+u(this).__description__+")"})),valueOf:i((function(){return u(this)}))}),h(r.prototype,r.toPrimitive,i("",(function(){var t=u(this);return"symbol"==typeof t?t:t.toString()}))),h(r.prototype,r.toStringTag,i("c","Symbol")),h(a.prototype,r.toStringTag,i("c",r.prototype[r.toStringTag])),h(a.prototype,r.toPrimitive,i("c",r.prototype[r.toPrimitive]))},function(t,e,n){"use strict";t.exports=function(t){return!!t&&("symbol"==typeof t||!!t.constructor&&("Symbol"===t.constructor.name&&"Symbol"===t[t.constructor.toStringTag]))}},function(t,e,n){"use strict";var r=n(5),a=Object.create,o=Object.defineProperty,i=Object.prototype,u=a(null);t.exports=function(t){for(var e,n,a=0;u[t+(a||"")];)++a;return u[t+=a||""]=!0,o(i,e="@@"+t,r.gs(null,(function(t){n||(n=!0,o(this,e,r(t)),n=!1)}))),e}},function(t,e,n){"use strict";var r=n(5),a=n(8).Symbol;t.exports=function(t){return Object.defineProperties(t,{hasInstance:r("",a&&a.hasInstance||t("hasInstance")),isConcatSpreadable:r("",a&&a.isConcatSpreadable||t("isConcatSpreadable")),iterator:r("",a&&a.iterator||t("iterator")),match:r("",a&&a.match||t("match")),replace:r("",a&&a.replace||t("replace")),search:r("",a&&a.search||t("search")),species:r("",a&&a.species||t("species")),split:r("",a&&a.split||t("split")),toPrimitive:r("",a&&a.toPrimitive||t("toPrimitive")),toStringTag:r("",a&&a.toStringTag||t("toStringTag")),unscopables:r("",a&&a.unscopables||t("unscopables"))})}},function(t,e,n){"use strict";var r=n(5),a=n(18),o=Object.create(null);t.exports=function(t){return Object.defineProperties(t,{for:r((function(e){return o[e]?o[e]:o[e]=t(String(e))})),keyFor:r((function(t){var e;for(e in a(t),o)if(o[e]===t)return e}))})}},function(t,e,n){"use strict";var r=Object.prototype.toString,a=r.call(function(){return arguments}());t.exports=function(t){return r.call(t)===a}},function(t,e,n){"use strict";var r=Object.prototype.toString,a=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);t.exports=function(t){return"function"==typeof t&&a(r.call(t))}},function(t,e,n){"use strict";var r=Object.prototype.toString,a=r.call("");t.exports=function(t){return"string"==typeof t||t&&"object"==typeof t&&(t instanceof String||r.call(t)===a)||!1}},function(t,e,n){"use strict";var r=n(1);t.exports=function(t){var e;return"function"==typeof t?{set:t,get:t}:(e={get:r(t.get)},void 0!==t.set?(e.set=r(t.set),t.delete&&(e.delete=r(t.delete)),t.clear&&(e.clear=r(t.clear)),e):(e.set=e.get,e))}},function(t,e,n){"use strict";t.exports=function(t){var e,n,r=t.length;if(!r)return"";for(e=String(t[n=0]);--r;)e+=""+t[++n];return e}},function(t,e,n){"use strict";t.exports=function(t){return t?function(e){for(var n=String(e[0]),r=0,a=t;--a;)n+=""+e[++r];return n}:function(){return""}}},function(t,e,n){"use strict";var r=n(10),a=Object.create;t.exports=function(){var t=0,e=[],n=a(null);return{get:function(t){var n,a=0,o=e,i=t.length;if(0===i)return o[i]||null;if(o=o[i]){for(;a<i-1;){if(-1===(n=r.call(o[0],t[a])))return null;o=o[1][n],++a}return-1===(n=r.call(o[0],t[a]))?null:o[1][n]||null}return null},set:function(a){var o,i=0,u=e,s=a.length;if(0===s)u[s]=++t;else{for(u[s]||(u[s]=[[],[]]),u=u[s];i<s-1;)-1===(o=r.call(u[0],a[i]))&&(o=u[0].push(a[i])-1,u[1].push([[],[]])),u=u[1][o],++i;-1===(o=r.call(u[0],a[i]))&&(o=u[0].push(a[i])-1),u[1][o]=++t}return n[t]=a,t},delete:function(t){var a,o=0,i=e,u=n[t],s=u.length,c=[];if(0===s)delete i[s];else if(i=i[s]){for(;o<s-1;){if(-1===(a=r.call(i[0],u[o])))return;c.push(i,a),i=i[1][a],++o}if(-1===(a=r.call(i[0],u[o])))return;for(t=i[1][a],i[0].splice(a,1),i[1].splice(a,1);!i[0].length&&c.length;)a=c.pop(),(i=c.pop())[0].splice(a,1),i[1].splice(a,1)}delete n[t]},clear:function(){e=[],n=a(null)}}}},function(t,e,n){"use strict";t.exports=n(71)()?Number.isNaN:n(72)},function(t,e,n){"use strict";t.exports=function(){var t=Number.isNaN;return"function"==typeof t&&(!t({})&&t(NaN)&&!t(34))}},function(t,e,n){"use strict";t.exports=function(t){return t!=t}},function(t,e,n){"use strict";var r=n(10);t.exports=function(){var t=0,e=[],n=[];return{get:function(t){var a=r.call(e,t[0]);return-1===a?null:n[a]},set:function(r){return e.push(r[0]),n.push(++t),t},delete:function(t){var a=r.call(n,t);-1!==a&&(e.splice(a,1),n.splice(a,1))},clear:function(){e=[],n=[]}}}},function(t,e,n){"use strict";var r=n(10),a=Object.create;t.exports=function(t){var e=0,n=[[],[]],o=a(null);return{get:function(e){for(var a,o=0,i=n;o<t-1;){if(-1===(a=r.call(i[0],e[o])))return null;i=i[1][a],++o}return-1===(a=r.call(i[0],e[o]))?null:i[1][a]||null},set:function(a){for(var i,u=0,s=n;u<t-1;)-1===(i=r.call(s[0],a[u]))&&(i=s[0].push(a[u])-1,s[1].push([[],[]])),s=s[1][i],++u;return-1===(i=r.call(s[0],a[u]))&&(i=s[0].push(a[u])-1),s[1][i]=++e,o[e]=a,e},delete:function(e){for(var a,i=0,u=n,s=[],c=o[e];i<t-1;){if(-1===(a=r.call(u[0],c[i])))return;s.push(u,a),u=u[1][a],++i}if(-1!==(a=r.call(u[0],c[i]))){for(e=u[1][a],u[0].splice(a,1),u[1].splice(a,1);!u[0].length&&s.length;)a=s.pop(),(u=s.pop())[0].splice(a,1),u[1].splice(a,1);delete o[e]}},clear:function(){n=[[],[]],o=a(null)}}}},function(t,e,n){"use strict";var r=n(9),a=n(19),o=n(16),i=n(15),u=n(11),s=Array.prototype.slice,c=Function.prototype.apply,l=Object.create;n(4).async=function(t,e){var n,f,p,d=l(null),h=l(null),g=e.memoized,m=e.original;e.memoized=i((function(t){var e=arguments,r=e[e.length-1];return"function"==typeof r&&(n=r,e=s.call(e,0,-1)),g.apply(f=this,p=e)}),g);try{o(e.memoized,g)}catch(t){}e.on("get",(function(t){var r,a,o;if(n){if(d[t])return"function"==typeof d[t]?d[t]=[d[t],n]:d[t].push(n),void(n=null);r=n,a=f,o=p,n=f=p=null,u((function(){var i;hasOwnProperty.call(h,t)?(i=h[t],e.emit("getasync",t,o,a),c.call(r,i.context,i.args)):(n=r,f=a,p=o,g.apply(a,o))}))}})),e.original=function(){var t,a,o,i;return n?(t=r(arguments),a=function t(n){var a,o,s=t.id;if(null!=s){if(delete t.id,a=d[s],delete d[s],a)return o=r(arguments),e.has(s)&&(n?e.delete(s):(h[s]={context:this,args:o},e.emit("setasync",s,"function"==typeof a?1:a.length))),"function"==typeof a?i=c.call(a,this,o):a.forEach((function(t){i=c.call(t,this,o)}),this),i}else u(c.bind(t,this,arguments))},o=n,n=f=p=null,t.push(a),i=c.call(m,this,t),a.cb=o,n=a,i):c.call(m,this,arguments)},e.on("set",(function(t){n?(d[t]?"function"==typeof d[t]?d[t]=[d[t],n.cb]:d[t].push(n.cb):d[t]=n.cb,delete n.cb,n.id=t,n=null):e.delete(t)})),e.on("delete",(function(t){var n;hasOwnProperty.call(d,t)||h[t]&&(n=h[t],delete h[t],e.emit("deleteasync",t,s.call(n.args,1)))})),e.on("clear",(function(){var t=h;h=l(null),e.emit("clearasync",a(t,(function(t){return s.call(t.args,1)})))}))}},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,a=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(a.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(a.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(77),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(21))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,a,o,i,u,s=1,c={},l=!1,f=t.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(t);p=p&&p.setTimeout?p:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick((function(){h(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){h(t.data)},r=function(t){o.port2.postMessage(t)}):f&&"onreadystatechange"in f.createElement("script")?(a=f.documentElement,r=function(t){var e=f.createElement("script");e.onreadystatechange=function(){h(t),e.onreadystatechange=null,a.removeChild(e),e=null},a.appendChild(e)}):r=function(t){setTimeout(h,0,t)}:(i="setImmediate$"+Math.random()+"$",u=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(i)&&h(+e.data.slice(i.length))},t.addEventListener?t.addEventListener("message",u,!1):t.attachEvent("onmessage",u),r=function(e){t.postMessage(i+e,"*")}),p.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var a={callback:t,args:e};return c[s]=a,r(s),s++},p.clearImmediate=d}function d(t){delete c[t]}function h(t){if(l)setTimeout(h,0,t);else{var e=c[t];if(e){l=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{d(t),l=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(21),n(20))},function(t,e,n){"use strict";var r=n(19),a=n(79),o=n(80),i=n(82),u=n(23),s=n(11),c=Object.create,l=a("then","then:finally","done","done:finally");n(4).promise=function(t,e){var n=c(null),a=c(null),f=c(null);if(!0===t)t=null;else if(t=o(t),!l[t])throw new TypeError("'"+i(t)+"' is not valid promise mode");e.on("set",(function(r,o,i){var c=!1;if(!u(i))return a[r]=i,void e.emit("setasync",r,1);n[r]=1,f[r]=i;var l=function(t){var o=n[r];if(c)throw new Error("Memoizee error: Detected unordered then|done & finally resolution, which in turn makes proper detection of success/failure impossible (when in 'done:finally' mode)\nConsider to rely on 'then' or 'done' mode instead.");o&&(delete n[r],a[r]=t,e.emit("setasync",r,o))},p=function(){c=!0,n[r]&&(delete n[r],delete f[r],e.delete(r))},d=t;if(d||(d="then"),"then"===d){var h=function(){s(p)};"function"==typeof(i=i.then((function(t){s(l.bind(this,t))}),h)).finally&&i.finally(h)}else if("done"===d){if("function"!=typeof i.done)throw new Error("Memoizee error: Retrieved promise does not implement 'done' in 'done' mode");i.done(l,p)}else if("done:finally"===d){if("function"!=typeof i.done)throw new Error("Memoizee error: Retrieved promise does not implement 'done' in 'done:finally' mode");if("function"!=typeof i.finally)throw new Error("Memoizee error: Retrieved promise does not implement 'finally' in 'done:finally' mode");i.done(l),i.finally(p)}})),e.on("get",(function(t,r,a){var o;if(n[t])++n[t];else{o=f[t];var i=function(){e.emit("getasync",t,r,a)};u(o)?"function"==typeof o.done?o.done(i):o.then((function(){s(i)})):i()}})),e.on("delete",(function(t){if(delete f[t],n[t])delete n[t];else if(hasOwnProperty.call(a,t)){var r=a[t];delete a[t],e.emit("deleteasync",t,[r])}})),e.on("clear",(function(){var t=a;a=c(null),n=c(null),f=c(null),e.emit("clearasync",r(t,(function(t){return[t]})))}))}},function(t,e,n){"use strict";var r=Array.prototype.forEach,a=Object.create;t.exports=function(t){var e=a(null);return r.call(arguments,(function(t){e[t]=!0})),e}},function(t,e,n){"use strict";var r=n(6),a=n(81);t.exports=function(t){return a(r(t))}},function(t,e,n){"use strict";var r=n(22);t.exports=function(t){try{return t&&r(t.toString)?t.toString():String(t)}catch(t){throw new TypeError("Passed argument cannot be stringifed")}}},function(t,e,n){"use strict";var r=n(83),a=/[\n\r\u2028\u2029]/g;t.exports=function(t){var e=r(t);return e.length>100&&(e=e.slice(0,99)+"…"),e=e.replace(a,(function(t){return JSON.stringify(t).slice(1,-1)}))}},function(t,e,n){"use strict";var r=n(22);t.exports=function(t){try{return t&&r(t.toString)?t.toString():String(t)}catch(t){return"<Non-coercible to string value>"}}},function(t,e,n){"use strict";var r=n(1),a=n(7),o=n(4),i=Function.prototype.apply;o.dispose=function(t,e,n){var u;if(r(t),n.async&&o.async||n.promise&&o.promise)return e.on("deleteasync",u=function(e,n){i.call(t,null,n)}),void e.on("clearasync",(function(t){a(t,(function(t,e){u(e,t)}))}));e.on("delete",u=function(e,n){t(n)}),e.on("clear",(function(t){a(t,(function(t,e){u(e,t)}))}))}},function(t,e,n){"use strict";var r=n(9),a=n(7),o=n(11),i=n(23),u=n(86),s=n(4),c=Function.prototype,l=Math.max,f=Math.min,p=Object.create;s.maxAge=function(t,e,n){var d,h,g,m;(t=u(t))&&(d=p(null),h=n.async&&s.async||n.promise&&s.promise?"async":"",e.on("set"+h,(function(n){d[n]=setTimeout((function(){e.delete(n)}),t),"function"==typeof d[n].unref&&d[n].unref(),m&&(m[n]&&"nextTick"!==m[n]&&clearTimeout(m[n]),m[n]=setTimeout((function(){delete m[n]}),g),"function"==typeof m[n].unref&&m[n].unref())})),e.on("delete"+h,(function(t){clearTimeout(d[t]),delete d[t],m&&("nextTick"!==m[t]&&clearTimeout(m[t]),delete m[t])})),n.preFetch&&(g=!0===n.preFetch||isNaN(n.preFetch)?.333:l(f(Number(n.preFetch),1),0))&&(m={},g=(1-g)*t,e.on("get"+h,(function(t,a,u){m[t]||(m[t]="nextTick",o((function(){var o;"nextTick"===m[t]&&(delete m[t],e.delete(t),n.async&&(a=r(a)).push(c),o=e.memoized.apply(u,a),n.promise&&i(o)&&("function"==typeof o.done?o.done(c,c):o.then(c,c)))})))}))),e.on("clear"+h,(function(){a(d,(function(t){clearTimeout(t)})),d={},m&&(a(m,(function(t){"nextTick"!==t&&clearTimeout(t)})),m={})})))}},function(t,e,n){"use strict";var r=n(3),a=n(87);t.exports=function(t){if((t=r(t))>a)throw new TypeError(t+" exceeds maximum possible timeout");return t}},function(t,e,n){"use strict";t.exports=2147483647},function(t,e,n){"use strict";var r=n(3),a=n(89),o=n(4);o.max=function(t,e,n){var i,u,s;(t=r(t))&&(u=a(t),i=n.async&&o.async||n.promise&&o.promise?"async":"",e.on("set"+i,s=function(t){void 0!==(t=u.hit(t))&&e.delete(t)}),e.on("get"+i,s),e.on("delete"+i,u.delete),e.on("clear"+i,u.clear))}},function(t,e,n){"use strict";var r=n(3),a=Object.create,o=Object.prototype.hasOwnProperty;t.exports=function(t){var e,n=0,i=1,u=a(null),s=a(null),c=0;return t=r(t),{hit:function(r){var a=s[r],l=++c;if(u[l]=r,s[r]=l,!a){if(++n<=t)return;return r=u[i],e(r),r}if(delete u[a],i===a)for(;!o.call(u,++i);)continue},delete:e=function(t){var e=s[t];if(e&&(delete u[e],delete s[t],--n,i===e)){if(!n)return c=0,void(i=1);for(;!o.call(u,++i);)continue}},clear:function(){n=0,i=1,u=a(null),s=a(null),c=0}}}},function(t,e,n){"use strict";var r=n(5),a=n(4),o=Object.create,i=Object.defineProperties;a.refCounter=function(t,e,n){var u,s;u=o(null),s=n.async&&a.async||n.promise&&a.promise?"async":"",e.on("set"+s,(function(t,e){u[t]=e||1})),e.on("get"+s,(function(t){++u[t]})),e.on("delete"+s,(function(t){delete u[t]})),e.on("clear"+s,(function(){u={}})),i(e.memoized,{deleteRef:r((function(){var t=e.get(arguments);return null===t?null:u[t]?!--u[t]&&(e.delete(t),!0):null})),getRefCount:r((function(){var t=e.get(arguments);return null===t?0:u[t]?u[t]:0}))})}},function(t,e,n){var r=n(92);"string"==typeof r&&(r=[[t.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(94)(r,a);r.locals&&(t.exports=r.locals)},function(t,e,n){(e=n(93)(!0)).push([t.i,".min-width-10 {\n  min-width: 10rem; }\n\n.min-width-12 {\n  min-width: 12rem; }\n\n.min-width-20 {\n  min-width: 20rem; }\n\n.gf-form-select-wrapper select.gf-form-input {\n  height: 2.64rem; }\n\n.gf-form-select-wrapper--caret-indent.gf-form-select-wrapper::after {\n  right: 0.775rem; }\n\n.ml-1 {\n  margin-left: 2px !important; }\n\n.join-r .gf-form-label {\n  margin-right: 0; }\n\n.join-l .gf-form-label {\n  border-left-width: 0;\n  border-radius: 0; }\n\n.mash-r .gf-form-label {\n  padding-right: 0; }\n\n.mash-l .gf-form-label {\n  padding-left: 0; }\n\n.irondb-tag-op .gf-form-label,\n.irondb-tag-end .gf-form-label {\n  color: #eb7b18; }\n\n.irondb-tag-cat .gf-form-label {\n  color: #598; }\n\n.irondb-tag-val .gf-form-label {\n  color: #5ca; }\n\n.irondb-tag-pair .gf-form-label,\n.irondb-tag-sep .gf-form-label {\n  color: #888; }\n\n.irondb-tag-op .gf-form-label:focus,\n.irondb-tag-op .gf-form-label:hover,\n.irondb-tag-cat .gf-form-label:focus,\n.irondb-tag-cat .gf-form-label:hover,\n.irondb-tag-val .gf-form-label:focus,\n.irondb-tag-val .gf-form-label:hover,\n.gf-form-label:focus .template-variable,\n.gf-form-label:hover .template-variable {\n  color: #fff; }\n\n/* menu item color changes */\n.irondb-tag-op .typeahead.dropdown-menu [data-value='REMOVE'] a {\n  color: #bb002c !important; }\n\n.irondb-tag-val .typeahead.dropdown-menu [data-value^='$'] a {\n  color: #33b5e5 !important; }\n\n.irondb-tag-op .typeahead.dropdown-menu [data-value='or('] a,\n.irondb-tag-op .typeahead.dropdown-menu [data-value='not('] a,\n.irondb-tag-op .typeahead.dropdown-menu [data-value='and('] a,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value='or('] a,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value='not('] a,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value='and('] a {\n  color: #eb7b18 !important; }\n\n.irondb-tag-op .typeahead.dropdown-menu [data-value='REMOVE'] a:focus,\n.irondb-tag-op .typeahead.dropdown-menu [data-value='REMOVE'] a:hover,\n.irondb-tag-val .typeahead.dropdown-menu [data-value^='$'] a:focus,\n.irondb-tag-val .typeahead.dropdown-menu [data-value^='$'] a:hover,\n.irondb-tag-op .typeahead.dropdown-menu [data-value='or('] a:focus,\n.irondb-tag-op .typeahead.dropdown-menu [data-value='or('] a:hover,\n.irondb-tag-op .typeahead.dropdown-menu [data-value='not('] a:focus,\n.irondb-tag-op .typeahead.dropdown-menu [data-value='not('] a:hover,\n.irondb-tag-op .typeahead.dropdown-menu [data-value='and('] a:focus,\n.irondb-tag-op .typeahead.dropdown-menu [data-value='and('] a:hover,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value='or('] a:focus,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value='or('] a:hover,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value='not('] a:focus,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value='not('] a:hover,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value='and('] a:focus,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value='and('] a:hover {\n  color: #fff !important; }\n","",{version:3,sources:["query_editor.css"],names:[],mappings:"AAAA;EACE,gBAAgB,EAAE;;AAEpB;EACE,gBAAgB,EAAE;;AAEpB;EACE,gBAAgB,EAAE;;AAEpB;EACE,eAAe,EAAE;;AAEnB;EACE,eAAe,EAAE;;AAEnB;EACE,2BAA2B,EAAE;;AAE/B;EACE,eAAe,EAAE;;AAEnB;EACE,oBAAoB;EACpB,gBAAgB,EAAE;;AAEpB;EACE,gBAAgB,EAAE;;AAEpB;EACE,eAAe,EAAE;;AAEnB;;EAEE,cAAc,EAAE;;AAElB;EACE,WAAW,EAAE;;AAEf;EACE,WAAW,EAAE;;AAEf;;EAEE,WAAW,EAAE;;AAEf;;;;;;;;EAQE,WAAW,EAAE;;AAEf,4BAA4B;AAC5B;EACE,yBAAyB,EAAE;;AAE7B;EACE,yBAAyB,EAAE;;AAE7B;;;;;;EAME,yBAAyB,EAAE;;AAE7B;;;;;;;;;;;;;;;;EAgBE,sBAAsB,EAAE",file:"query_editor.css",sourcesContent:[".min-width-10 {\n  min-width: 10rem; }\n\n.min-width-12 {\n  min-width: 12rem; }\n\n.min-width-20 {\n  min-width: 20rem; }\n\n.gf-form-select-wrapper select.gf-form-input {\n  height: 2.64rem; }\n\n.gf-form-select-wrapper--caret-indent.gf-form-select-wrapper::after {\n  right: 0.775rem; }\n\n.ml-1 {\n  margin-left: 2px !important; }\n\n.join-r .gf-form-label {\n  margin-right: 0; }\n\n.join-l .gf-form-label {\n  border-left-width: 0;\n  border-radius: 0; }\n\n.mash-r .gf-form-label {\n  padding-right: 0; }\n\n.mash-l .gf-form-label {\n  padding-left: 0; }\n\n.irondb-tag-op .gf-form-label,\n.irondb-tag-end .gf-form-label {\n  color: #eb7b18; }\n\n.irondb-tag-cat .gf-form-label {\n  color: #598; }\n\n.irondb-tag-val .gf-form-label {\n  color: #5ca; }\n\n.irondb-tag-pair .gf-form-label,\n.irondb-tag-sep .gf-form-label {\n  color: #888; }\n\n.irondb-tag-op .gf-form-label:focus,\n.irondb-tag-op .gf-form-label:hover,\n.irondb-tag-cat .gf-form-label:focus,\n.irondb-tag-cat .gf-form-label:hover,\n.irondb-tag-val .gf-form-label:focus,\n.irondb-tag-val .gf-form-label:hover,\n.gf-form-label:focus .template-variable,\n.gf-form-label:hover .template-variable {\n  color: #fff; }\n\n/* menu item color changes */\n.irondb-tag-op .typeahead.dropdown-menu [data-value='REMOVE'] a {\n  color: #bb002c !important; }\n\n.irondb-tag-val .typeahead.dropdown-menu [data-value^='$'] a {\n  color: #33b5e5 !important; }\n\n.irondb-tag-op .typeahead.dropdown-menu [data-value='or('] a,\n.irondb-tag-op .typeahead.dropdown-menu [data-value='not('] a,\n.irondb-tag-op .typeahead.dropdown-menu [data-value='and('] a,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value='or('] a,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value='not('] a,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value='and('] a {\n  color: #eb7b18 !important; }\n\n.irondb-tag-op .typeahead.dropdown-menu [data-value='REMOVE'] a:focus,\n.irondb-tag-op .typeahead.dropdown-menu [data-value='REMOVE'] a:hover,\n.irondb-tag-val .typeahead.dropdown-menu [data-value^='$'] a:focus,\n.irondb-tag-val .typeahead.dropdown-menu [data-value^='$'] a:hover,\n.irondb-tag-op .typeahead.dropdown-menu [data-value='or('] a:focus,\n.irondb-tag-op .typeahead.dropdown-menu [data-value='or('] a:hover,\n.irondb-tag-op .typeahead.dropdown-menu [data-value='not('] a:focus,\n.irondb-tag-op .typeahead.dropdown-menu [data-value='not('] a:hover,\n.irondb-tag-op .typeahead.dropdown-menu [data-value='and('] a:focus,\n.irondb-tag-op .typeahead.dropdown-menu [data-value='and('] a:hover,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value='or('] a:focus,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value='or('] a:hover,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value='not('] a:focus,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value='not('] a:hover,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value='and('] a:focus,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value='and('] a:hover {\n  color: #fff !important; }\n"]}]),t.exports=e},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"==typeof btoa){var a=(i=r,u=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(u),"/*# ".concat(s," */")),o=r.sources.map((function(t){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(t," */")}));return[n].concat(o).concat([a]).join("\n")}var i,u,s;return[n].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,r){"string"==typeof t&&(t=[[null,t,""]]);var a={};if(r)for(var o=0;o<this.length;o++){var i=this[o][0];null!=i&&(a[i]=!0)}for(var u=0;u<t.length;u++){var s=[].concat(t[u]);r&&a[s[0]]||(n&&(s[2]?s[2]="".concat(n," and ").concat(s[2]):s[2]=n),e.push(s))}},e}},function(t,e,n){var r,a,o={},i=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===a&&(a=r.apply(this,arguments)),a}),u=function(t,e){return e?e.querySelector(t):document.querySelector(t)},s=function(t){var e={};return function(t,n){if("function"==typeof t)return t();if(void 0===e[t]){var r=u.call(this,t,n);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}e[t]=r}return e[t]}}(),c=null,l=0,f=[],p=n(95);function d(t,e){for(var n=0;n<t.length;n++){var r=t[n],a=o[r.id];if(a){a.refs++;for(var i=0;i<a.parts.length;i++)a.parts[i](r.parts[i]);for(;i<r.parts.length;i++)a.parts.push(b(r.parts[i],e))}else{var u=[];for(i=0;i<r.parts.length;i++)u.push(b(r.parts[i],e));o[r.id]={id:r.id,refs:1,parts:u}}}}function h(t,e){for(var n=[],r={},a=0;a<t.length;a++){var o=t[a],i=e.base?o[0]+e.base:o[0],u={css:o[1],media:o[2],sourceMap:o[3]};r[i]?r[i].parts.push(u):n.push(r[i]={id:i,parts:[u]})}return n}function g(t,e){var n=s(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=f[f.length-1];if("top"===t.insertAt)r?r.nextSibling?n.insertBefore(e,r.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),f.push(e);else if("bottom"===t.insertAt)n.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var a=s(t.insertAt.before,n);n.insertBefore(e,a)}}function m(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=f.indexOf(t);e>=0&&f.splice(e,1)}function y(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var r=function(){0;return n.nc}();r&&(t.attrs.nonce=r)}return v(e,t.attrs),g(t,e),e}function v(t,e){Object.keys(e).forEach((function(n){t.setAttribute(n,e[n])}))}function b(t,e){var n,r,a,o;if(e.transform&&t.css){if(!(o="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=o}if(e.singleton){var i=l++;n=c||(c=y(e)),r=S.bind(null,n,i,!1),a=S.bind(null,n,i,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",v(e,t.attrs),g(t,e),e}(e),r=A.bind(null,n,e),a=function(){m(n),n.href&&URL.revokeObjectURL(n.href)}):(n=y(e),r=_.bind(null,n),a=function(){m(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else a()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=i()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=h(t,e);return d(n,e),function(t){for(var r=[],a=0;a<n.length;a++){var i=n[a];(u=o[i.id]).refs--,r.push(u)}t&&d(h(t,e),e);for(a=0;a<r.length;a++){var u;if(0===(u=r[a]).refs){for(var s=0;s<u.parts.length;s++)u.parts[s]();delete o[u.id]}}}};var T,w=(T=[],function(t,e){return T[t]=e,T.filter(Boolean).join("\n")});function S(t,e,n,r){var a=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=w(e,a);else{var o=document.createTextNode(a),i=t.childNodes;i[e]&&t.removeChild(i[e]),i.length?t.insertBefore(o,i[e]):t.appendChild(o)}}function _(t,e){var n=e.css,r=e.media;if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function A(t,e,n){var r=n.css,a=n.sourceMap,o=void 0===e.convertToAbsoluteUrls&&a;(e.convertToAbsoluteUrls||o)&&(r=p(r)),a&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */");var i=new Blob([r],{type:"text/css"}),u=t.href;t.href=URL.createObjectURL(i),u&&URL.revokeObjectURL(u)}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,r=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(t,e){var a,o=e.trim().replace(/^"(.*)"$/,(function(t,e){return e})).replace(/^'(.*)'$/,(function(t,e){return e}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?t:(a=0===o.indexOf("//")?o:0===o.indexOf("/")?n+o:r+o.replace(/^\.\//,""),"url("+JSON.stringify(a)+")")}))}},function(t,e,n){"use strict";n.r(e);var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function a(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,a,o=n.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(t){a={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return i}var i=n(0),u=n.n(i);function s(t){return t=" ["+t+"] ",function(e){return console.log((new Date).toISOString()+t+e())}}var c,l=n(24),f=n.n(l),p=s("IrondbQuery");function d(t,e){var n,r;void 0===e&&(e=!0);var o={};try{for(var i=a(t.split(/,/g)),s=i.next();!s.done;s=i.next()){var c=s.value.split(/:/g),l=c.shift(),f=c.join(":");e&&(l=A(l),f=A(f));var p=o[l];u.a.isUndefined(p)&&(o[l]=p=[]),p.push(f)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o}function h(t){var e="",n=t.indexOf("ST[");return-1!==n&&(e=t.substring(n+3,t.length-1),t=t.substring(0,n-1)),[t,e]}function g(t){return h(t)[0]}!function(t){t[t.MetricName=0]="MetricName",t[t.TagCat=1]="TagCat",t[t.TagVal=2]="TagVal",t[t.TagPair=3]="TagPair",t[t.TagSep=4]="TagSep",t[t.TagEnd=5]="TagEnd",t[t.TagOp=6]="TagOp",t[t.TagPlus=7]="TagPlus"}(c||(c={}));var m={};function y(t,e){for(var n=0,r=new Map,a=0;a<t.length;a++){var i=o(h(t[a].metric_name),2),u=(i[0],d(i[1])),s=void 0!==u[e]?u[e][0]:m;void 0===r.get(s)&&(n+=1),r.set(s,!0)}return n>1}var v=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];function T(t){return 1===v[t]}function w(t){return 1===b[t]}function S(t,e){for(var n=0,r=0;r<t.length;r++){e(t.charCodeAt(r))&&(n+=1)}return n===t.length}function _(t,e,n){void 0===n&&(n=!0),t===c.MetricName&&(t=c.TagVal);var r=!1;if((t!==c.TagCat||function(t){return S(t,T)}(e))&&(t!==c.TagVal||function(t){return S(t,w)}(e)||1===e.length&&"*"===e.charAt(0))||(r=!0),r){var a='"';n&&(a="!"),e=["b",a,btoa(e),a].join("")}return e}function A(t){return(t.startsWith('b"')&&t.endsWith('"')||t.startsWith("b!")&&t.endsWith("!"))&&(t=atob(t.slice(2,t.length-1))),t}function E(t){var e=o(h(t),2),n=(e[0],d(e[1]).statsd_type);return!(void 0===n||!n.includes("count"))}var x=function(){function t(t,e,n,r){this.datasource=t,this.target=e,this.parseTarget()}return t.$inject=["datasource","target","templateSrv","scopedVars"],t.prototype.parseTarget=function(){var t,e,n=this;if(this.segments=[],this.error=null,!this.target.rawQuery){p((function(){return"parseTarget() target = "+JSON.stringify(n.target)}));var r=this.target.query,o=(r=r.slice(11,-1)||"*").split(",");r=o.shift(),this.segments.push({type:c.MetricName,value:A(r)});var i=!0;try{for(var s=a(o),l=s.next();!l.done;l=s.next()){var f=l.value;i?i=!1:this.segments.push({type:c.TagSep});var d=(f=f.split(":")).shift(),h=f.join(":"),g=!1,m=4;d.startsWith("and(")||d.startsWith("not(")?g=!0:d.startsWith("or(")&&(g=!0,m=3),g&&(this.segments.push({type:c.TagOp,value:d.slice(0,m)}),d=d.slice(m)),this.segments.push({type:c.TagCat,value:A(d)}),this.segments.push({type:c.TagPair});for(var y=0;h.endsWith(")");)h=h.slice(0,-1),y++;this.segments.push({type:c.TagVal,value:A(h)});for(var v=0;v<y;v++)this.segments.push({type:c.TagPlus}),this.segments.push({type:c.TagEnd})}}catch(e){t={error:e}}finally{try{l&&!l.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}0===o.length&&this.segments.push({type:c.TagPlus}),p((function(){return"parseTarget() SegmentType = "+JSON.stringify(u.a.map(n.segments,(function(t){return c[t.type]})))}))}},t.prototype.updateSegmentValue=function(t,e){var n=this;p((function(){return"updateSegmentValue() "+e+" segment = "+JSON.stringify(t)})),p((function(){return"updateSegmentValue() length = "+n.segments.length})),void 0!==this.segments[e]&&(this.segments[e].value=t.value)},t.prototype.addSelectMetricSegment=function(){this.segments.push({value:"select metric"})},t}(),O=s("IrondbDatasource"),C={ms:1,s:1e3,m:6e4,h:36e5,d:864e5};function j(t){if(!/^[0-9]+(ms|s|m|h|d)?$/g.test(t.toLocaleLowerCase()))throw new Error("Invalid time duration: "+t);var e="s";for(var n in C)t.endsWith(n)&&(e=n,t=t.slice(0,t.length-n.length));return parseInt(t,10)*C[e]}var M=[[1,.5,.25,.2,.1,.05,.025,.02,.01,.005,.002,.001],[60,30,20,15,10,5,3,2,1],[60,30,20,15,10,5,3,2,1].map((function(t){return 60*t})),[24,12,8,6,4,3,2,1].map((function(t){return 60*t*60}))];function q(t,e){if(-1!==e&&(e=1),t<.001)return.001;for(var n=0;n<M.length;n++){var r=M[n];if(t<r[0])for(var a=1;a<r.length;a++){if(t>r[a])return-1===e?r[a]:r[a-1];if(t===r[a])return r[a]}}return t%86400==0?t:1===e?86400*(1+Math.floor(t/86400)):86400*Math.floor(t/86400)}var P={count:"count",average:"average",stddev:"stddev",derive:"rate",derive_stddev:"derive_stddev",counter:"rate",counter_stddev:"counter_stddev"},N=function(){function t(e,n,r,a){this.$q=n,this.backendSrv=r,this.templateSrv=a,this.type="irondb",this.name=e.name,this.id=e.id,this.accountId=(e.jsonData||{}).accountId,this.irondbType=(e.jsonData||{}).irondbType,this.resultsLimit=(e.jsonData||{}).resultsLimit,this.apiToken=(e.jsonData||{}).apiToken,this.useCaching=(e.jsonData||{}).useCaching,this.activityTracking=(e.jsonData||{}).activityTracking,this.url=e.url,this.supportAnnotations=!1,this.supportMetrics=!0,this.appName="Grafana",this.datasourceRequest=t.setupCache(this.useCaching,r)}return t.$inject=["instanceSettings","$q","backendSrv","templateSrv"],t.stripActivityWindow=function(t){return u.a.split(t,"&").map((function(t){return t.split("=")})).filter((function(t){return!t[0].startsWith("activity_")})).map((function(t){return t.join("=")})).join("&")},t.requestCacheKey=function(e){var n=e.method;if("GET"===n)return t.stripActivityWindow(e.url);if("POST"===n)return JSON.stringify(e.data);throw new Error("Unsupported HTTP method type: "+(n||"?"))},t.setupCache=function(e,n){var r=function(t){return n.datasourceRequest(t)};if(!e)return O((function(){return"setupCache() caching disabled"})),r;var a={max:t.DEFAULT_CACHE_ENTRIES,maxAge:t.DEFAULT_CACHE_TIME_MS,promise:!0,normalizer:function(e){var n=e[0],r=t.requestCacheKey(n);return O((function(){return"normalizer() cache lookup key = "+r})),r}};return O((function(){return"setupCache() caching enabled"})),f()((function(e){return O((function(){return"doRequest() cache miss key = "+t.requestCacheKey(e)})),r(e)}),a)},t.prototype.query=function(t){var e=this;(O((function(){return"query() options = "+JSON.stringify(t)})),u.a.isUndefined(this.queryRange)||u.a.isEqual(t.rangeRaw,this.queryRange))||(O((function(){return"query() time range changed "+JSON.stringify(e.queryRange)+" -> "+JSON.stringify(t.rangeRaw)})),this.useCaching&&(O((function(){return"query() clearing cache"})),this.datasourceRequest.clear()));return this.queryRange=t.rangeRaw,u.a.isEmpty(t.targets[0])?this.$q.when({data:[]}):Promise.all([this.buildIrondbParams(t)]).then((function(t){return u.a.isEmpty(t[0])?e.$q.when({data:[]}):e.irondbRequest(t[0])})).then((function(t){return t.data.constructor===Array&&t.data.sort((function(t,e){return t.target.localeCompare(e.target)})),O((function(){return"query() queryResults = "+JSON.stringify(t)})),t})).catch((function(t){(0!==t.status||t.status>=300)&&e.throwerr(t)}))},t.prototype.annotationQuery=function(t){throw new Error("Annotation Support not implemented yet.")},t.prototype.interpolateExpr=function(t,e){if(void 0===t&&(t=[]),!e.multi&&!e.includeAll)return t;if("string"==typeof t)return t;if(1===t.length)return t[0];for(var n="",r=0;r<t.length;r++)r>0&&(n+=","),n+=t[r],r+=1;return n},t.prototype.metricFindQuery=function(t,e){var n=e.variable;if(O((function(){return"Options: "+JSON.stringify(e)})),""!==t&&void 0!==n&&(""!==n.regex||n.useTags)){O((function(){return"metricFindQuery() incoming query = "+t})),O((function(){return"metricFindQuery() incoming regex = "+n.regex}));var r=this.templateSrv.replace(t,null,this.interpolateExpr),a=n.tagValuesQuery;return O((function(){return"metricFindQuery() interpolatedQuery = "+r})),O((function(){return"metricFindQuery() tagCat = "+a})),r.includes("and(")||r.includes("or(")||r.includes("not(")||(r="and(__name:"+r+")"),""!==a?this.metricTagValsQuery(r,a).then((function(t){return u.a.map(t.data,(function(t){return{value:t}}))})):this.metricTagsQuery(r).then((function(t){return u.a.map(t.data,(function(t){return{value:t.metric_name}}))}))}return Promise.resolve([])},t.prototype.getAccountId=function(){return"standalone"===this.irondbType?"/"+this.accountId:""},t.prototype.metricTagsQuery=function(t,e,n){if(void 0===e&&(e=!1),void 0===n&&(n=null),""===t||void 0===t||!e&&"and(__name:*)"===t)return Promise.resolve({data:[]});var r="/find"+this.getAccountId()+"/tags?query=";return r+=t,this.activityTracking&&!u.a.isEmpty(n)&&(O((function(){return"metricTagsQuery() activityWindow = "+JSON.stringify(n)})),r+="&activity_start_secs="+u.a.toInteger(n[0]),r+="&activity_end_secs="+u.a.toInteger(n[1])),O((function(){return"metricTagsQuery() queryUrl = "+r})),this.irondbSimpleRequest("GET",r,!1,!0)},t.prototype.metricTagCatsQuery=function(t){var e="/find"+this.getAccountId()+"/tag_cats?query="+t;return O((function(){return"metricTagCatsQuery() queryUrl = "+e})),this.irondbSimpleRequest("GET",e,!1,!0,!1)},t.prototype.metricTagValsQuery=function(t,e){var n="/find"+this.getAccountId()+"/tag_vals?category="+e+"&query=";return n+=t,O((function(){return"metricTagValsQuery() queryUrl = "+n})),this.irondbSimpleRequest("GET",n,!1,!0,!1)},t.prototype.testDatasource=function(){return this.metricTagsQuery("and(__name:ametric)").then((function(t){var e=u.a.get(t,"results[0].error");return e?{status:"error",message:e,title:"Error"}:{status:"success",message:"Data source is working",title:"Success"}})).catch((function(t){var e=(t.data||{}).message;return void 0===e&&(e="Error "+(t.status||"")+" "+(t.statusText||"")),{status:"error",message:e,title:"Error"}}))},t.prototype.throwerr=function(t){if(O((function(){return"throwerr() err = "+t})),t.data&&t.data.error)throw new Error("Circonus IRONdb Error: "+t.data.error);if(t.data&&t.data.user_error){var e=t.data.method||"IRONdb",n="";throw t.data.user_error.query&&(n=' in"'+t.data.user_error.query+'"'),new Error(e+" error: "+t.data.user_error.message+n)}throw"Not Found"===t.statusText?new Error("Circonus IRONdb Error: "+t.statusText):t.statusText&&t.status>0?new Error("Network Error: "+t.statusText+"("+t.status+")"):new Error("Error: "+(t?t.toString():"unknown"))},t.prototype.irondbSimpleRequest=function(t,e,n,r,a){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===a&&(a=!0);var o=this.url,i={"Content-Type":"application/json"};"hosted"!==this.irondbType&&(i["X-Circonus-Account"]=this.accountId),"hosted"!==this.irondbType||n||(o+="/irondb",r||(o+="/series_multi"),i["X-Circonus-Auth-Token"]=this.apiToken,i["X-Circonus-App-Name"]=this.appName),i["X-Snowth-Advisory-Limit"]=a?this.resultsLimit:"none","standalone"!==this.irondbType||n||r||(o+="/series_multi"),n&&!r&&(o+="/extension/lua/caql_v1");var u={method:t,url:o+e,headers:i,retry:1};return O((function(){return"irondbSimpleRequest() options = "+JSON.stringify(u)})),this.datasourceRequest(u)},t.prototype.irondbRequest=function(t,e){var n=this;void 0===e&&(e=!0),O((function(){return"irondbRequest() irondbOptions = "+JSON.stringify(t)}));var r={"Content-Type":"application/json"},a={},o=[],i={data:[]};if("hosted"===this.irondbType?(r["X-Circonus-Auth-Token"]=this.apiToken,r["X-Circonus-App-Name"]=this.appName):r["X-Circonus-Account"]=this.accountId,r["X-Snowth-Advisory-Limit"]=e?this.resultsLimit:"none",r.Accept="application/json",t.std.names.length)for(var u=t.std.names[0].leaf_data.paneltype||"Graph",s=function(e){(a={}).url=c.url,"hosted"===c.irondbType&&(a.url=a.url+"/irondb"),a.url=a.url+"/fetch",a.method="POST";var n=[],i=t.std.start,s=t.std.end,l=c.getRollupSpan(t,i,s,!1,t.std.names[e].leaf_data);i-=l,s+=l;var f="Heatmap"===u?"merge":"pass",p=[],d={streams:p};d.period=l,d.start=i,d.count=Math.round((s-i)/l),d.reduce=[{label:"",method:f}];var h=t.std.names[e].leaf_data.metrictype;n.push(t.std.names[e].leaf_data.metriclabel);var g={},m=t.std.names[e].leaf_data.egress_function;if("histogram"===h)if("Heatmap"===u)m="none";else{m=P[m];var y="default";E(t.std.names[e].leaf_name)&&(y="statsd_counter"),t.std.names[e].leaf_data.target.hist_transform=y}g.transform=m,g.name=t.std.names[e].leaf_name,g.uuid=t.std.names[e].leaf_data.uuid,g.kind=h,p.push(g),O((function(){return"irondbRequest() data = "+JSON.stringify(d)})),a.data=d,a.name="fetch",a.headers=r,(c.basicAuth||c.withCredentials)&&(a.withCredentials=!0),c.basicAuth&&(a.headers.Authorization=c.basicAuth),a.metricLabels=n,a.paneltype=u,a.isCaql=!1,a.retry=1,o.push(a)},c=this,l=0;l<t.std.names.length;l++)s(l);if(t.caql.names.length)for(l=0;l<t.caql.names.length;l++){(a={}).url=this.url,"hosted"===this.irondbType&&(a.url=a.url+"/irondb"),a.method="GET",a.url=a.url+"/extension/lua","hosted"===this.irondbType&&(a.url=a.url+"/public");var f=t.caql.start,p=t.caql.end,d=this.getRollupSpan(t,f,p,!0,t.caql.names[l].leaf_data);f-=d,p+=d;var h=this.templateSrv.replace(t.caql.names[l].leaf_name);a.url=a.url+"/caql_v1?format=DF4&start="+f.toFixed(3),a.url=a.url+"&end="+p.toFixed(3),a.url=a.url+"&period="+d,a.url=a.url+"&q="+encodeURIComponent(h),a.name=t.caql.names[l],a.headers=r,a.start=f,a.end=p,a.retry=1,(this.basicAuth||this.withCredentials)&&(a.withCredentials=!0),this.basicAuth&&(a.headers.Authorization=this.basicAuth),a.isCaql=!0,o.push(a)}return O((function(){return"irondbRequest() queries = "+JSON.stringify(o)})),Promise.all(o.map((function(t){return n.datasourceRequest(t).then((function(e){return O((function(){return"irondbRequest() query = "+JSON.stringify(t)})),O((function(){return"irondbRequest() result = "+JSON.stringify(e)})),n.convertIrondbDf4DataToGrafana(e,t)})).then((function(t){if(t.data.constructor===Array)for(var e=0;e<t.data.length;e++)i.data.push(t.data[e]);return t.data.constructor===Object&&i.data.push(t.data),i}))}))).then((function(t){return i})).catch((function(t){(0!==t.status||t.status>=300)&&n.throwerr(t)}))},t.checkRollupAligned=function(e){var n,r;try{for(var o=a(t.ROLLUP_ALIGN_MS),i=o.next();!i.done;i=o.next()){var u=i.value;if(e<u&&u%e!=0)throw new Error("Unaligned rollup period requested")}}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}if(e>t.ROLLUP_ALIGN_MS_1DAY&&e%t.ROLLUP_ALIGN_MS_1DAY!=0)throw new Error("Unaligned rollup period requested")},t.prototype.getRollupSpan=function(e,n,r,a,o){O((function(){return"getRollupSpan() intervalMs = "+e.intervalMs+", maxDataPoints = "+e.maxDataPoints})),O((function(){return"getRollupSpan() "+(a?"CAQL":"/fetch")+" "+JSON.stringify(o)}));var i=o.rolluptype,s=o.metricrollup;if("automatic"!==i&&u.a.isEmpty(s)&&(i="automatic",O((function(){return"getRollupSpan() defaulting to automatic"}))),"exact"===i){var c=j(s),l=Math.floor(1e3*(r-n)/c);if(O((function(){return"getRollupSpan() exactMs = "+c+", exactDatapoints = "+l})),l>e.maxDataPoints*t.MAX_EXACT_DATAPOINTS_THRESHOLD)throw new Error("Too many datapoints requested");return t.checkRollupAligned(c),c/1e3}var f=t.MIN_DURATION_MS_FETCH;a&&(f=t.MIN_DURATION_MS_CAQL),"minimum"===i&&(f=j(s),O((function(){return"getRollupSpan() minimumMs = "+f})));var p=e.intervalMs;p<f&&(p=f);for(var d=q(p/1e3,-1);(r-n)/d>e.maxDatapoints*t.MAX_DATAPOINTS_THRESHOLD;)d=q(d+.001,1);return O((function(){return"getRollupSpan() intervalMs = "+p+" -> interval "+d})),d},t.prototype.filterMetricsByType=function(t,e){return u.a.filter(e,(function(t){var e=t.type.split(",");return!u.a.includes(e,"text")}))},t.prototype.buildFetchStream=function(t,e,n){e[n].leaf_data={egress_function:"average",uuid:e[n].uuid,paneltype:e[n].target.paneltype,target:t};var r,i,s,c,l=e[n].metric_name;if("average"!==t.egressoverride&&("automatic"===t.egressoverride?E(l)&&(e[n].leaf_data.egress_function="counter"):e[n].leaf_data.egress_function=t.egressoverride),"default"!==t.labeltype){var f=t.metriclabel;"name"===t.labeltype?f="%n":"cardinality"===t.labeltype&&(f="%n | %t-{*}"),r=f,c=(i=e)[s=n],f=r.replace(/%d/g,(s+1).toString()).replace(/%n/g,g(c.metric_name)).replace(/%cn/g,c.metric_name).replace(/%tv-?{([^}]*)}/g,(function(t){var e,n,r=t.substring(3,4),s="-"===r?y:function(){return!0},l=t.substring("-"===r?5:4,t.length-1),f=o(h(c.metric_name),2),p=(f[0],d(f[1]));if("*"===l){var g=[];try{for(var m=a(u.a.keys(p)),v=m.next();!v.done;v=m.next()){var b=v.value;!b.startsWith("__")&&s(i,b)&&g.push(b)}}catch(t){e={error:t}}finally{try{v&&!v.done&&(n=m.return)&&n.call(m)}finally{if(e)throw e.error}}return g.sort(),u.a.map(g,(function(t){return p[t][0]})).join(",")}return void 0!==p[l]&&s(i,l)?p[l][0]:""})).replace(/%t-?{([^}]*)}/g,(function(t){var e,n,r=t.substring(2,3),s="-"===r?y:function(){return!0},l=t.substring("-"===r?4:3,t.length-1),f=o(h(c.metric_name),2),p=(f[0],d(f[1]));if("*"===l){var g=[];try{for(var m=a(u.a.keys(p)),v=m.next();!v.done;v=m.next()){var b=v.value;if(!b.startsWith("__")&&s(i,b)){var T=p[b][0];g.push(b+":"+T)}}}catch(t){e={error:t}}finally{try{v&&!v.done&&(n=m.return)&&n.call(m)}finally{if(e)throw e.error}}return g.sort(),g.join(",")}return void 0!==p[l]&&s(i,l)?l+":"+p[l][0]:""})),f=this.templateSrv.replace(f),e[n].leaf_data.metriclabel=f}return"automatic"===t.rolluptype||u.a.isEmpty(t.metricrollup)||(e[n].leaf_data.rolluptype=t.rolluptype,e[n].leaf_data.metricrollup=t.metricrollup),e[n].leaf_data.metrictype=e[n].type,{leaf_name:l,leaf_data:e[n].leaf_data}},t.prototype.buildFetchParamsAsync=function(t,e,n,r){var a=this,o=this.templateSrv.replace(e.query);return this.metricTagsQuery(o,!1,[n,r]).then((function(t){t.data=a.filterMetricsByType(e,t.data);for(var n=0;n<t.data.length;n++)t.data[n].target=e;return t.data})).then((function(n){for(var r=0;r<n.length;r++)t.std.names.push(a.buildFetchStream(e,n,r));return t}))},t.prototype.buildIrondbParamsAsync=function(t){var e=this,n={},r=new Date(t.range.from).getTime()/1e3,a=new Date(t.range.to).getTime()/1e3,o=Math.round((t.range.to.valueOf()-t.range.from.valueOf())/t.maxDataPoints);n.maxDataPoints=t.maxDataPoints,n.intervalMs=o,n.std={},n.std.start=r,n.std.end=a,n.std.names=[],n.caql={},n.caql.start=r,n.caql.end=a,n.caql.names=[];var i=u.a.reject(t.targets,(function(t){return t.hide||!t.query||0===t.query.length}));if(!i.length)return{};var s=i.map((function(t){return t.isCaql?(n.caql.names.push({leaf_name:t.query,leaf_data:{rolluptype:t.rolluptype,metricrollup:t.metricrollup}}),Promise.resolve(n)):e.buildFetchParamsAsync(n,t,r,a)}));return Promise.all(s).then((function(t){return n})).catch((function(t){O((function(){return"buildIrondbParams() err = "+JSON.stringify(t)})),0!==t.status||t.status}))},t.prototype.buildIrondbParams=function(t){var e=this;return new Promise((function(n,r){n(e.buildIrondbParamsAsync(t))}))},t.prototype.convertIrondbDf4DataToGrafana=function(t,e){var n=e.name,r=e.metricLabels||{},i=t.data.data,s=t.data.meta,c=[],l=t.data.head.start,f=t.data.head.period,p=t.data.head.error;if(!u.a.isEmpty(p))throw new Error(p.join("\n"));if(!i||0===i.length)return{data:c};for(var d={},g=function(t){var p,g,m,y,v=n+" ["+(t+1)+"]",b=s[t]?s[t].label:v;b=(p=o(h(b),2))[0],y=p[1];var T=r[t];u.a.isString(T)&&(b=T),O((function(){return"convertIrondbDf4DataToGrafana() tags: "+y}));var w={};if(""!==y){try{for(var S=(g=void 0,a(y.split(/,/g))),_=S.next();!_.done;_=S.next()){var E=_.value.split(/:/g),x=E.shift(),C=E.join(":");x=A(x),C=A(C),w[x]=C}}catch(t){g={error:t}}finally{try{_&&!_.done&&(m=S.return)&&m.call(S)}finally{if(g)throw g.error}}w.__name=b}O((function(){return"convertIrondbDf4DataToGrafana() Labels: "+JSON.stringify(w)}));for(var j=0;j<i[t].length;j++)if(null!==i[t][j]){var M=1e3*(l+j*f);if(!(M<1e3*e.start))if(i[t][j].constructor===Number)void 0===c[t]&&(c[t]={target:b,tags:w,datapoints:[]}),c[t].datapoints.push([i[t][j],M]);else if(i[t][j].constructor===Object)for(var q in i[t][j]){var P=i[t][j][q];q=parseFloat(q).toString();var N=M.toString();u.a.isUndefined(d[q])&&(d[q]={target:q,tags:w,datapoints:[],_ts:{}},c.push(d[q])),u.a.isUndefined(d[q]._ts[N])?(d[q]._ts[N]=[P,M],d[q].datapoints.push(d[q]._ts[N])):d[q]._ts[N][0]+=P}}},m=0;m<i.length;m++)g(m);for(var y=function(t){if(u.a.isUndefined(c[t]))return O((function(){return"convertIrondbDf4DataToGrafana() No data at "+l+" for "+s[t].kind+' "'+s[t].label+'"'})),"continue";delete c[t]._ts},v=0;v<c.length;v++)y(v);return{data:u.a.compact(c)}},t.DEFAULT_CACHE_ENTRIES=128,t.DEFAULT_CACHE_TIME_MS=6e4,t.MAX_DATAPOINTS_THRESHOLD=1.5,t.MAX_EXACT_DATAPOINTS_THRESHOLD=1.5,t.MIN_DURATION_MS_FETCH=1,t.MIN_DURATION_MS_CAQL=6e4,t.ROLLUP_ALIGN_MS=u.a.map([1,60,3600,86400],(function(t){return 1e3*t})),t.ROLLUP_ALIGN_MS_1DAY=864e5,t}(),I=n(25),R=n(26),L=n.n(R),k=(n(91),s("IrondbQueryCtrl"));var D=function(t){function e(e,n,r,a){var o=t.call(this,e,n)||this;return o.uiSegmentSrv=r,o.templateSrv=a,o.defaults={},o.labelTypeOptions=[{value:"default",text:"name and tags"},{value:"name",text:"name only"},{value:"cardinality",text:"high cardinality tags"},{value:"custom",text:"custom"}],o.egressTypeOptions=[{value:"automatic",text:"automatic"},{value:"count",text:"number of data points (count)"},{value:"average",text:"average value (gauge)"},{value:"stddev",text:"standard deviation a.k.a. σ (stddev)"},{value:"derive",text:"rate of change (derive)"},{value:"derive_stddev",text:"rate of change σ (derive_stddev)"},{value:"counter",text:"rate of positive change (counter)"},{value:"counter_stddev",text:"rate of positive change σ (counter_stddev)"}],o.rollupTypeOptions=[{value:"automatic",text:"automatic"},{value:"minimum",text:"minimum"},{value:"exact",text:"exact"}],o.caqlFindFunctions={count:"count",average:"average",stddev:"stddev",derive:"derivative",derive_stddev:"derivative_stddev",counter:"counter",counter_stddev:"counter_stddev"},o.histogramTransforms={count:" | histogram:count()",average:" | histogram:mean()",stddev:" | histogram:stddev()",derive:" | histogram:rate()",derive_stddev:"",counter:" | histogram:rate()",counter_stddev:""},u.a.defaultsDeep(o.target,o.defaults),o.target.isCaql=o.target.isCaql||!1,o.target.egressoverride=o.target.egressoverride||"average",o.target.metriclabel=o.target.metriclabel||"",o.target.labeltype=o.target.labeltype||"default",o.target.rolluptype=o.target.rolluptype||"automatic",o.target.query=o.target.query||"",o.target.segments=o.target.segments||[],o.target.paneltype=o.panelCtrl.pluginName,o.queryModel=new x(o.datasource,o.target,a),o.buildSegments(),o.updateMetricLabelValue(!1),o}return e.$inject=["$scope","$injector","uiSegmentSrv","templateSrv"],function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.resetQueryTarget=function(){k((function(){return"resetQueryTarget()"})),this.target.isCaql=!1,this.target.query="",this.target.egressoverride="average",this.target.labeltype="default",this.target.rolluptype="automatic",this.emptySegments(),this.parseTarget(),this.panelCtrl.refresh()},e.prototype.toggleEditorMode=function(){var t=this;if(k((function(){return"toggleEditorMode()"})),this.target.isCaql){var e=function(){t.resetQueryTarget()};""===this.target.query?setTimeout(e,0):L.a.emit("confirm-modal",{title:"Warning",text2:"Switching to query builder may overwrite your raw CAQL.",icon:"fa-exclamation",yesText:"Switch",onConfirm:e})}else{this.target.isCaql=!0;var n=this.segmentsToCaqlFind();k((function(){return"toggleEditorMode() caqlQuery = "+n})),this.target.query=n,this.panelCtrl.refresh()}},e.prototype.labelTypeValueChanged=function(){"custom"===this.target.labeltype&&setTimeout((function(){document.getElementById("metriclabel").focus()}),50),this.panelCtrl.refresh()},e.prototype.metricLabelKeyUp=function(t){var e=this,n=t.currentTarget;13===t.keyCode&&setTimeout((function(){e.target.metriclabel=n.value,e.updateMetricLabelValue()}),0)},e.prototype.updateMetricLabelValue=function(t){void 0===t&&(t=!0),""===this.target.metriclabel&&"custom"===this.target.labeltype&&(this.target.labeltype="default"),t&&this.panelCtrl.refresh()},e.prototype.rollupTypeValueChanged=function(){var t=!0;"automatic"!==this.target.rolluptype&&(u.a.isEmpty(this.target.metricrollup)&&(t=!1),setTimeout((function(){document.getElementById("metricrollup").focus()}),50)),t&&this.panelCtrl.refresh()},e.prototype.metricRollupKeyUp=function(t){var e=this,n=t.currentTarget;13===t.keyCode&&setTimeout((function(){e.target.metricrollup=n.value,e.updateMetricRollupValue()}),0)},e.prototype.updateMetricRollupValue=function(t){void 0===t&&(t=!0),""===this.target.metricrollup&&"automatic"!==this.target.rolluptype&&(this.target.rolluptype="automatic"),t&&this.panelCtrl.refresh()},e.prototype.egressValueChanged=function(){this.panelCtrl.refresh()},e.prototype.onChangeInternal=function(){this.panelCtrl.refresh()},e.prototype.getCollapsedText=function(){return this.target.isCaql?this.target.query:this.segmentsToCaqlFind()},e.prototype.getSegments=function(t,e){var n=this;k((function(){return"getSegments() "+t+" prefix = "+e}));var r=e&&e.length>0?e:"",o=this.segments[t]._type;if(k((function(){return"getSegments() "+t+" SegmentType = "+c[o]})),o===c.MetricName)return _(c.MetricName,r)!==r?r="b/"+btoa(String(r).replace(/[\\^$*+?.()|[\]{}]/g,"\\$&"))+"/":r+="*",this.datasource.metricTagsQuery("and(__name:"+r+")",!0).then((function(t){var e=u.a.map(t.data,(function(t){return g(t.metric_name)}));return e=u.a.uniq(e),k((function(){return"getSegments() metricnames = "+JSON.stringify(e)})),u.a.map(e,(function(t){return n.newSegment(c.MetricName,{value:t,expandable:!0})}))})).catch((function(t){return k((function(){return"getSegments() err = "+t.toString()})),[]}));if(o===c.TagCat||o===c.TagPlus){var i=_(c.MetricName,this.segments[0].value);return k((function(){return"getSegments() tags for "+i})),this.datasource.metricTagCatsQuery(i).then((function(t){var e,r;if(t.data&&t.data.length>0){var i=t.data,u=[];try{for(var s=a(i),l=s.next();!l.done;l=s.next()){var f=l.value;u.push(n.newSegment(c.TagCat,{value:A(f),expandable:!0}))}}catch(t){e={error:t}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return o===c.TagPlus&&(u.unshift(n.newSegment(c.TagOp,{value:"and("})),u.unshift(n.newSegment(c.TagOp,{value:"not("})),u.unshift(n.newSegment(c.TagOp,{value:"or("}))),u}})).catch((function(t){return k((function(){return"getSegments() err = "+t})),[]}))}if(o===c.TagOp){var s=[this.newSegment(c.TagOp,{value:"REMOVE"}),this.newSegment(c.TagOp,{value:"and("}),this.newSegment(c.TagOp,{value:"not("}),this.newSegment(c.TagOp,{value:"or("})];return Promise.resolve(s)}if(o===c.TagVal){var l=_(c.MetricName,this.segments[0].value),f=this.segments[t-2].value;return"select tag"===f?Promise.resolve([]):(k((function(){return"getSegments() tag vals for "+l+", "+f})),this.datasource.metricTagValsQuery(l,_(c.TagCat,f,!1)).then((function(t){var e,r;if(t.data&&t.data.length>0){var o=t.data,i=[];i.push(n.newSegment(c.TagVal,{value:"*",expandable:!0})),u.a.eachRight(n.templateSrv.variables,(function(t){i.push(n.newSegment(c.TagVal,{type:"template",value:"$"+t.name,expandable:!0}))}));try{for(var s=a(o),l=s.next();!l.done;l=s.next()){var f=l.value;i.push(n.newSegment(c.TagVal,{value:A(f),expandable:!0}))}}catch(t){e={error:t}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return i}})).catch((function(t){return k((function(){return"getSegments() err = "+t})),[]})))}return Promise.resolve([])},e.prototype.parseTarget=function(){this.queryModel.parseTarget(),this.buildSegments()},e.prototype.setSegmentType=function(t,e){return t._type=e,t._typeName=c[e],t},e.prototype.newSegment=function(t,e){var n=this.uiSegmentSrv.newSegment(e);return this.setSegmentType(n,t)},e.prototype.mapSegment=function(t){var e;return e=t.type===c.TagOp?this.uiSegmentSrv.newOperator(t.value):t.type===c.TagEnd?this.uiSegmentSrv.newOperator(")"):t.type===c.TagPair?this.uiSegmentSrv.newCondition(":"):t.type===c.TagSep?this.uiSegmentSrv.newCondition(","):t.type===c.TagPlus?this.buildSelectTagPlusSegment():this.uiSegmentSrv.newSegment(t),this.setSegmentType(e,t.type)},e.prototype.buildSegments=function(){var t=this;this.segments=u.a.map(this.queryModel.segments,(function(e){return t.mapSegment(e)})),k((function(){return"buildSegments()"}));var e=this.queryModel.checkOtherSegmentsIndex||0;this.checkOtherSegments(e)},e.prototype.addSelectMetricSegment=function(){this.queryModel.addSelectMetricSegment();var t=this.uiSegmentSrv.newSelectMetric();this.setSegmentType(t,c.MetricName),this.segments.push(t)},e.prototype.buildSelectTagPlusSegment=function(){var t=this.uiSegmentSrv.newPlusButton();return this.setSegmentType(t,c.TagPlus),t},e.prototype.addSelectTagPlusSegment=function(){this.segments.push(this.buildSelectTagPlusSegment())},e.prototype.newSelectTagValSegment=function(){var t=this.uiSegmentSrv.newKeyValue("*");return this.setSegmentType(t,c.TagVal),t},e.prototype.checkOtherSegments=function(t){if(t===this.segments.length){var e=this.segments[t-1]._type;k((function(){return"checkOtherSegments() "+(t-1)+" SegmentType = "+c[e]})),e===c.MetricName&&this.addSelectTagPlusSegment()}return Promise.resolve()},e.prototype.setSegmentFocus=function(t){u.a.each(this.segments,(function(e,n){e.focus=t===n}))},e.prototype.segmentValueChanged=function(t,e){var n=this;if(k((function(){return"segmentValueChanged()"})),this.error=null,this.queryModel.updateSegmentValue(t,e),t._type!==c.TagOp){if(t._type===c.TagPlus){if("and("===t.value||"not("===t.value||"or("===t.value)return this.segments.splice(e,1),e>2&&this.segments.splice(e,0,this.mapSegment({type:c.TagSep})),this.segments.splice(e+1,0,this.mapSegment({type:c.TagOp,value:t.value}),this.mapSegment({type:c.TagCat,value:"select tag",fake:!0}),this.mapSegment({type:c.TagPair}),this.newSelectTagValSegment(),this.buildSelectTagPlusSegment(),this.mapSegment({type:c.TagEnd})),e>2&&this.segments.splice(e+7,0,this.buildSelectTagPlusSegment()),void this.setSegmentFocus(e+3);this.segments.splice(e,1),e>2&&this.segments.splice(e,0,this.mapSegment({type:c.TagSep})),this.segments.splice(e+1,0,this.mapSegment({type:c.TagCat,value:t.value}),this.mapSegment({type:c.TagPair}),this.newSelectTagValSegment(),this.buildSelectTagPlusSegment()),1===e&&(this.segments.splice(e,0,this.mapSegment({type:c.TagOp,value:"and("})),this.segments.push(this.mapSegment({type:c.TagEnd})))}if(0===e&&this.spliceSegments(e+1),t.expandable)return this.checkOtherSegments(e+1).then((function(){n.setSegmentFocus(e+1),n.targetChanged()}));this.setSegmentFocus(e+1),this.targetChanged()}else{if("REMOVE"===t.value){for(var r=e+1,a=1,o=this.segments.length;a>0&&r<o;){var i=this.segments[r]._type;if(i===c.TagOp)a++;else if(i===c.TagEnd&&0===--a)break;r++}var u=e,s=r-e+1;e>2&&(u--,s++),this.segments.splice(u,s),o===r+1&&this.segments.push(this.buildSelectTagPlusSegment())}this.targetChanged()}},e.prototype.spliceSegments=function(t){this.segments=this.segments.splice(0,t),this.queryModel.segments=this.queryModel.segments.splice(0,t)},e.prototype.emptySegments=function(){this.queryModel.segments=[],this.segments=[]},e.prototype.segmentsToStreamTags=function(){var t,e,n=this.segments.slice(),r=n.shift().value,o="and(__name:"+_(c.MetricName,r),i=!1;try{for(var u=a(n),s=u.next();!s.done;s=u.next()){var l=s.value,f=l._type;f!==c.TagPlus&&(i||f===c.TagEnd||f===c.TagSep||(o+=","),i=f===c.TagOp||f===c.TagPair||f===c.TagCat||f===c.TagSep,o+=_(f,l.value))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}return o+=")"},e.prototype.queryFunctionToCaqlFind=function(){if("Heatmap"===this.target.paneltype||void 0!==this.target.hist_transform)return"find:histogram";var t="find",e=this.target.egressoverride;return"average"!==e&&(t+=":"+(e=this.caqlFindFunctions[e])),t},e.prototype.buildHistogramTransform=function(){if(void 0!==this.target.hist_transform){var t=this.target.egressoverride;return"automatic"===t&&(t="statsd_counter"===this.target.hist_transform?"counter":"average"),this.histogramTransforms[t]}return""},e.prototype.buildCaqlLabel=function(){var t=this.target.labeltype,e=this.target.metriclabel;if("default"!==t){if("custom"===t&&""!==e)return" | label('"+(e=e.replace(/'/g,'"'))+"')";if("name"===t)return" | label('%n')";if("cardinality"===t)return" | label('%n | %t-{*}')"}return" | label('%cn')"},e.prototype.segmentsToCaqlFind=function(){var t,e,n=this.segments.slice(),r=n.shift().value,o=1===n.length&&n[0]._type===c.TagPlus;if("*"===r&&o)return"";var i=this.queryFunctionToCaqlFind()+"('"+r+"'";if(o)return i+=")"+this.buildHistogramTransform()+this.buildCaqlLabel();var u=!0,s=!1;try{for(var l=a(n),f=l.next();!f.done;f=l.next()){var p=f.value,d=p._type;d!==c.TagPlus&&(s||d===c.TagEnd||d===c.TagSep||(i+=",",u&&(i+=" '",u=!1)),s=d===c.TagOp||d===c.TagPair||d===c.TagCat||d===c.TagSep,i+=_(d,p.value))}}catch(e){t={error:e}}finally{try{f&&!f.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}return i+="')"+this.buildHistogramTransform()+this.buildCaqlLabel()},e.prototype.updateModelTarget=function(){var t=this.segmentsToStreamTags();k((function(){return"updateModelTarget() streamTags = "+t})),this.queryModel.target.query=t},e.prototype.targetChanged=function(){if(k((function(){return"targetChanged()"})),!this.queryModel.error){var t=this.queryModel.target.query;this.updateModelTarget(),this.queryModel.target!==t&&this.panelCtrl.refresh()}},e.templateUrl="partials/query.editor.html",e}(I.QueryCtrl),F=function(){function t(t){this.current.jsonData.irondbType=this.current.jsonData.irondbType||"standalone",this.current.jsonData.resultsLimit=this.current.jsonData.resultsLimit||"100",this.current.jsonData.useCaching=u.a.defaultTo(this.current.jsonData.useCaching,!0),this.current.jsonData.activityTracking=u.a.defaultTo(this.current.jsonData.activityTracking,!0)}return t.$inject=["$scope"],t.templateUrl="partials/config.html",t}();n.d(e,"AnnotationsQueryCtrl",(function(){return B})),n.d(e,"Datasource",(function(){return N})),n.d(e,"QueryCtrl",(function(){return D})),n.d(e,"ConfigCtrl",(function(){return F}));var B=function(){function t(){}return t.templateUrl="partials/annotations.editor.html",t}()}])}));
//# sourceMappingURL=module.js.map