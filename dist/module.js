define(["lodash","app/plugins/sdk"],function(e,t){return function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=7)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t,r){var a=r(3);"string"==typeof a&&(a=[[e.i,a,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};r(5)(a,n);a.locals&&(e.exports=a.locals)},function(e,t,r){(e.exports=r(4)(!0)).push([e.i,'.min-width-10 {\n  min-width: 10rem; }\n\n.min-width-12 {\n  min-width: 12rem; }\n\n.min-width-20 {\n  min-width: 20rem; }\n\n.gf-form-select-wrapper select.gf-form-input {\n  height: 2.64rem; }\n\n.gf-form-select-wrapper--caret-indent.gf-form-select-wrapper::after {\n  right: 0.775rem; }\n\n.ml-1 {\n  margin-left: 2px !important; }\n\n.join-r .gf-form-label {\n  margin-right: 0; }\n\n.join-l .gf-form-label {\n  border-left-width: 0;\n  border-radius: 0; }\n\n.mash-r .gf-form-label {\n  padding-right: 0; }\n\n.mash-l .gf-form-label {\n  padding-left: 0; }\n\n.irondb-tag-op .gf-form-label,\n.irondb-tag-end .gf-form-label {\n  color: #eb7b18; }\n\n.irondb-tag-cat .gf-form-label {\n  color: #598; }\n\n.irondb-tag-val .gf-form-label {\n  color: #5ca; }\n\n.irondb-tag-pair .gf-form-label,\n.irondb-tag-sep .gf-form-label {\n  color: #888; }\n\n.irondb-tag-op .gf-form-label:focus,\n.irondb-tag-op .gf-form-label:hover,\n.irondb-tag-cat .gf-form-label:focus,\n.irondb-tag-cat .gf-form-label:hover,\n.irondb-tag-val .gf-form-label:focus,\n.irondb-tag-val .gf-form-label:hover,\n.gf-form-label:focus .template-variable,\n.gf-form-label:hover .template-variable {\n  color: #fff; }\n\n/* menu item color changes */\n.irondb-tag-op .typeahead.dropdown-menu [data-value="REMOVE"] a {\n  color: #bb002c !important; }\n\n.irondb-tag-val .typeahead.dropdown-menu [data-value^="$"] a {\n  color: #33b5e5 !important; }\n\n.irondb-tag-op .typeahead.dropdown-menu [data-value="or("] a,\n.irondb-tag-op .typeahead.dropdown-menu [data-value="not("] a,\n.irondb-tag-op .typeahead.dropdown-menu [data-value="and("] a,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value="or("] a,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value="not("] a,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value="and("] a {\n  color: #eb7b18 !important; }\n\n.irondb-tag-op .typeahead.dropdown-menu [data-value="REMOVE"] a:focus,\n.irondb-tag-op .typeahead.dropdown-menu [data-value="REMOVE"] a:hover,\n.irondb-tag-val .typeahead.dropdown-menu [data-value^="$"] a:focus,\n.irondb-tag-val .typeahead.dropdown-menu [data-value^="$"] a:hover,\n.irondb-tag-op .typeahead.dropdown-menu [data-value="or("] a:focus,\n.irondb-tag-op .typeahead.dropdown-menu [data-value="or("] a:hover,\n.irondb-tag-op .typeahead.dropdown-menu [data-value="not("] a:focus,\n.irondb-tag-op .typeahead.dropdown-menu [data-value="not("] a:hover,\n.irondb-tag-op .typeahead.dropdown-menu [data-value="and("] a:focus,\n.irondb-tag-op .typeahead.dropdown-menu [data-value="and("] a:hover,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value="or("] a:focus,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value="or("] a:hover,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value="not("] a:focus,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value="not("] a:hover,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value="and("] a:focus,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value="and("] a:hover {\n  color: #fff !important; }\n',"",{version:3,sources:["query_editor.css"],names:[],mappings:"AAAA;EACE,gBAAgB,EAAE;;AAEpB;EACE,gBAAgB,EAAE;;AAEpB;EACE,gBAAgB,EAAE;;AAEpB;EACE,eAAe,EAAE;;AAEnB;EACE,eAAe,EAAE;;AAEnB;EACE,2BAA2B,EAAE;;AAE/B;EACE,eAAe,EAAE;;AAEnB;EACE,oBAAoB;EACpB,gBAAgB,EAAE;;AAEpB;EACE,gBAAgB,EAAE;;AAEpB;EACE,eAAe,EAAE;;AAEnB;;EAEE,cAAc,EAAE;;AAElB;EACE,WAAW,EAAE;;AAEf;EACE,WAAW,EAAE;;AAEf;;EAEE,WAAW,EAAE;;AAEf;;;;;;;;EAQE,WAAW,EAAE;;AAEf,4BAA4B;AAC5B;EACE,yBAAyB,EAAE;;AAE7B;EACE,yBAAyB,EAAE;;AAE7B;;;;;;EAME,yBAAyB,EAAE;;AAE7B;;;;;;;;;;;;;;;;EAgBE,sBAAsB,EAAE",file:"query_editor.css",sourcesContent:['.min-width-10 {\n  min-width: 10rem; }\n\n.min-width-12 {\n  min-width: 12rem; }\n\n.min-width-20 {\n  min-width: 20rem; }\n\n.gf-form-select-wrapper select.gf-form-input {\n  height: 2.64rem; }\n\n.gf-form-select-wrapper--caret-indent.gf-form-select-wrapper::after {\n  right: 0.775rem; }\n\n.ml-1 {\n  margin-left: 2px !important; }\n\n.join-r .gf-form-label {\n  margin-right: 0; }\n\n.join-l .gf-form-label {\n  border-left-width: 0;\n  border-radius: 0; }\n\n.mash-r .gf-form-label {\n  padding-right: 0; }\n\n.mash-l .gf-form-label {\n  padding-left: 0; }\n\n.irondb-tag-op .gf-form-label,\n.irondb-tag-end .gf-form-label {\n  color: #eb7b18; }\n\n.irondb-tag-cat .gf-form-label {\n  color: #598; }\n\n.irondb-tag-val .gf-form-label {\n  color: #5ca; }\n\n.irondb-tag-pair .gf-form-label,\n.irondb-tag-sep .gf-form-label {\n  color: #888; }\n\n.irondb-tag-op .gf-form-label:focus,\n.irondb-tag-op .gf-form-label:hover,\n.irondb-tag-cat .gf-form-label:focus,\n.irondb-tag-cat .gf-form-label:hover,\n.irondb-tag-val .gf-form-label:focus,\n.irondb-tag-val .gf-form-label:hover,\n.gf-form-label:focus .template-variable,\n.gf-form-label:hover .template-variable {\n  color: #fff; }\n\n/* menu item color changes */\n.irondb-tag-op .typeahead.dropdown-menu [data-value="REMOVE"] a {\n  color: #bb002c !important; }\n\n.irondb-tag-val .typeahead.dropdown-menu [data-value^="$"] a {\n  color: #33b5e5 !important; }\n\n.irondb-tag-op .typeahead.dropdown-menu [data-value="or("] a,\n.irondb-tag-op .typeahead.dropdown-menu [data-value="not("] a,\n.irondb-tag-op .typeahead.dropdown-menu [data-value="and("] a,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value="or("] a,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value="not("] a,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value="and("] a {\n  color: #eb7b18 !important; }\n\n.irondb-tag-op .typeahead.dropdown-menu [data-value="REMOVE"] a:focus,\n.irondb-tag-op .typeahead.dropdown-menu [data-value="REMOVE"] a:hover,\n.irondb-tag-val .typeahead.dropdown-menu [data-value^="$"] a:focus,\n.irondb-tag-val .typeahead.dropdown-menu [data-value^="$"] a:hover,\n.irondb-tag-op .typeahead.dropdown-menu [data-value="or("] a:focus,\n.irondb-tag-op .typeahead.dropdown-menu [data-value="or("] a:hover,\n.irondb-tag-op .typeahead.dropdown-menu [data-value="not("] a:focus,\n.irondb-tag-op .typeahead.dropdown-menu [data-value="not("] a:hover,\n.irondb-tag-op .typeahead.dropdown-menu [data-value="and("] a:focus,\n.irondb-tag-op .typeahead.dropdown-menu [data-value="and("] a:hover,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value="or("] a:focus,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value="or("] a:hover,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value="not("] a:focus,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value="not("] a:hover,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value="and("] a:focus,\n.irondb-tag-plus .typeahead.dropdown-menu [data-value="and("] a:hover {\n  color: #fff !important; }\n']}])},function(e,t,r){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var r=function(e,t){var r=e[1]||"",a=e[3];if(!a)return r;if(t&&"function"==typeof btoa){var n=(i=a,s=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),u="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(u," */")),o=a.sources.map(function(e){return"/*# sourceURL=".concat(a.sourceRoot).concat(e," */")});return[r].concat(o).concat([n]).join("\n")}var i,s,u;return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2],"{").concat(r,"}"):r}).join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var a={},n=0;n<this.length;n++){var o=this[n][0];null!=o&&(a[o]=!0)}for(var i=0;i<e.length;i++){var s=e[i];null!=s[0]&&a[s[0]]||(r&&!s[2]?s[2]=r:r&&(s[2]="(".concat(s[2],") and (").concat(r,")")),t.push(s))}},t}},function(e,t,r){var a,n,o={},i=(a=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===n&&(n=a.apply(this,arguments)),n}),s=function(e,t){return t?t.querySelector(e):document.querySelector(e)},u=function(e){var t={};return function(e,r){if("function"==typeof e)return e();if(void 0===t[e]){var a=s.call(this,e,r);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}t[e]=a}return t[e]}}(),l=null,d=0,p=[],c=r(6);function g(e,t){for(var r=0;r<e.length;r++){var a=e[r],n=o[a.id];if(n){n.refs++;for(var i=0;i<n.parts.length;i++)n.parts[i](a.parts[i]);for(;i<a.parts.length;i++)n.parts.push(b(a.parts[i],t))}else{var s=[];for(i=0;i<a.parts.length;i++)s.push(b(a.parts[i],t));o[a.id]={id:a.id,refs:1,parts:s}}}}function f(e,t){for(var r=[],a={},n=0;n<e.length;n++){var o=e[n],i=t.base?o[0]+t.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};a[i]?a[i].parts.push(s):r.push(a[i]={id:i,parts:[s]})}return r}function h(e,t){var r=u(e.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var a=p[p.length-1];if("top"===e.insertAt)a?a.nextSibling?r.insertBefore(t,a.nextSibling):r.appendChild(t):r.insertBefore(t,r.firstChild),p.push(t);else if("bottom"===e.insertAt)r.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var n=u(e.insertAt.before,r);r.insertBefore(t,n)}}function m(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=p.indexOf(e);t>=0&&p.splice(t,1)}function v(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var a=function(){0;return r.nc}();a&&(e.attrs.nonce=a)}return y(t,e.attrs),h(e,t),t}function y(e,t){Object.keys(t).forEach(function(r){e.setAttribute(r,t[r])})}function b(e,t){var r,a,n,o;if(t.transform&&e.css){if(!(o="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=o}if(t.singleton){var i=d++;r=l||(l=v(t)),a=S.bind(null,r,i,!1),n=S.bind(null,r,i,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",y(t,e.attrs),h(e,t),t}(t),a=E.bind(null,r,t),n=function(){m(r),r.href&&URL.revokeObjectURL(r.href)}):(r=v(t),a=w.bind(null,r),n=function(){m(r)});return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else n()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=i()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var r=f(e,t);return g(r,t),function(e){for(var a=[],n=0;n<r.length;n++){var i=r[n];(s=o[i.id]).refs--,a.push(s)}e&&g(f(e,t),t);for(n=0;n<a.length;n++){var s;if(0===(s=a[n]).refs){for(var u=0;u<s.parts.length;u++)s.parts[u]();delete o[s.id]}}}};var A,T=(A=[],function(e,t){return A[e]=t,A.filter(Boolean).join("\n")});function S(e,t,r,a){var n=r?"":a.css;if(e.styleSheet)e.styleSheet.cssText=T(t,n);else{var o=document.createTextNode(n),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(o,i[t]):e.appendChild(o)}}function w(e,t){var r=t.css,a=t.media;if(a&&e.setAttribute("media",a),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}function E(e,t,r){var a=r.css,n=r.sourceMap,o=void 0===t.convertToAbsoluteUrls&&n;(t.convertToAbsoluteUrls||o)&&(a=c(a)),n&&(a+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var i=new Blob([a],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(i),s&&URL.revokeObjectURL(s)}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var r=t.protocol+"//"+t.host,a=r+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var n,o=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?e:(n=0===o.indexOf("//")?o:0===o.indexOf("/")?r+o:a+o.replace(/^\.\//,""),"url("+JSON.stringify(n)+")")})}},function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var i;function s(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function u(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,n,o=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}function l(e,t){var r,a;void 0===t&&(t=!0);var o={};try{for(var i=s(e.split(/,/g)),u=i.next();!u.done;u=i.next()){var l=u.value.split(/:/g),d=l.shift(),p=l.join(":");t&&(d=T(d),p=T(p));var c=o[d];n.a.isUndefined(c)&&(o[d]=c=[]),c.push(p)}}catch(e){r={error:e}}finally{try{u&&!u.done&&(a=i.return)&&a.call(i)}finally{if(r)throw r.error}}return o}function d(e){var t="",r=e.indexOf("ST[");return-1!=r&&(t=e.substring(r+3,e.length-1),e=e.substring(0,r-1)),[e,t]}function p(e){return d(e)[0]}!function(e){e[e.MetricName=0]="MetricName",e[e.TagCat=1]="TagCat",e[e.TagVal=2]="TagVal",e[e.TagPair=3]="TagPair",e[e.TagSep=4]="TagSep",e[e.TagEnd=5]="TagEnd",e[e.TagOp=6]="TagOp",e[e.TagPlus=7]="TagPlus"}(i||(i={}));var c={};function g(e,t){for(var r=0,a=new Map,n=0;n<e.length;n++){var o=u(d(e[n].metric_name),2),i=(o[0],l(o[1])),s=void 0!==i[t]?i[t][0]:c;void 0===a.get(s)&&(r+=1),a.set(s,!0)}return r>1}function f(e,t,r){var a=t[r],o=e.replace(/%d/g,(r+1).toString());return o=(o=(o=(o=o.replace(/%n/g,p(a.metric_name))).replace(/%cn/g,a.metric_name)).replace(/%tv-?{([^}]*)}/g,function(e){var r,o,i=e.substring(3,4),p="-"===i?g:function(){return!0},c=e.substring("-"===i?5:4,e.length-1),f=u(d(a.metric_name),2),h=(f[0],l(f[1]));if("*"===c){var m=[];try{for(var v=s(n.a.keys(h)),y=v.next();!y.done;y=v.next()){var b=y.value;!b.startsWith("__")&&p(t,b)&&m.push(b)}}catch(e){r={error:e}}finally{try{y&&!y.done&&(o=v.return)&&o.call(v)}finally{if(r)throw r.error}}return m.sort(),n.a.map(m,function(e){return h[e][0]}).join(",")}return void 0!==h[c]&&p(t,c)?h[c][0]:""})).replace(/%t-?{([^}]*)}/g,function(e){var r,o,i=e.substring(2,3),p="-"===i?g:function(){return!0},c=e.substring("-"===i?4:3,e.length-1),f=u(d(a.metric_name),2),h=(f[0],l(f[1]));if("*"===c){var m=[];try{for(var v=s(n.a.keys(h)),y=v.next();!y.done;y=v.next()){var b=y.value;if(!b.startsWith("__")&&p(t,b)){var A=h[b][0];m.push(b+":"+A)}}}catch(e){r={error:e}}finally{try{y&&!y.done&&(o=v.return)&&o.call(v)}finally{if(r)throw r.error}}return m.sort(),m.join(",")}return void 0!==h[c]&&p(t,c)?c+":"+h[c][0]:""})}var h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];function v(e){return 1==h[e]}function y(e){return 1==m[e]}function b(e,t){for(var r=0,a=0;a<e.length;a++){t(e.charCodeAt(a))&&(r+=1)}return r===e.length}function A(e,t,r){void 0===r&&(r=!0),e===i.MetricName&&(e=i.TagVal);var a=!1;if((e!==i.TagCat||function(e){return b(e,v)}(t))&&(e!==i.TagVal||function(e){return b(e,y)}(t)||1===t.length&&"*"===t.charAt(0))||(a=!0),a){var n='"';r&&(n="!"),t=["b",n,btoa(t),n].join("")}return t}function T(e){return(e.startsWith('b"')&&e.endsWith('"')||e.startsWith("b!")&&e.endsWith("!"))&&(e=atob(e.slice(2,e.length-1))),e}var S=function(){function e(e,t,r,a){this.datasource=e,this.target=t,this.parseTarget()}return e.$inject=["datasource","target","templateSrv","scopedVars"],e.prototype.parseTarget=function(){var e,t;if(this.segments=[],this.error=null,!this.target.rawQuery){var r=this.target.query,a=(r=r.slice(11,-1)||"*").split(",");r=a.shift(),this.segments.push({type:i.MetricName,value:T(r)});var n=!0;try{for(var o=s(a),u=o.next();!u.done;u=o.next()){var l=u.value;n?n=!1:this.segments.push({type:i.TagSep});var d=(l=l.split(":")).shift(),p=l.join(":"),c=!1,g=4;d.startsWith("and(")||d.startsWith("not(")?c=!0:d.startsWith("or(")&&(c=!0,g=3),c&&(this.segments.push({type:i.TagOp,value:d.slice(0,g)}),d=d.slice(g)),this.segments.push({type:i.TagCat,value:T(d)}),this.segments.push({type:i.TagPair});for(var f=0;p.endsWith(")");)p=p.slice(0,-1),f++;this.segments.push({type:i.TagVal,value:T(p)});for(var h=0;h<f;h++)this.segments.push({type:i.TagPlus}),this.segments.push({type:i.TagEnd})}}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}0===a.length&&this.segments.push({type:i.TagPlus})}},e.prototype.getSegmentPathUpTo=function(e){var t=this.segments.slice(0,e);return n.a.reduce(t,function(e,t){return e?e+t.value+".":t.value+"."},"")},e.prototype.parseTargetRecursive=function(e,t){if(null===e)return null;switch(e.type){case"metric":this.segments=e.segments}},e.prototype.updateSegmentValue=function(e,t){void 0!==this.segments[t]&&(this.segments[t].value=e.value)},e.prototype.addSelectMetricSegment=function(){this.segments.push({value:"select metric"})},e.prototype.updateModelTarget=function(e){var t,r;this.updateRenderedTarget(this.target,e);try{for(var a=s(e||[]),n=a.next();!n.done;n=a.next()){var o=n.value;o.refId!==this.target.refId&&this.updateRenderedTarget(o,e)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}},e.prototype.updateRenderedTarget=function(e,t){var r=n.a.keyBy(t,"refId");delete r[e.refId];var a=e.query;n.a.each(r,function(e,t){!function(e,t){n.a.each(e,function(e,t){}),e[t].refCount=0}(r,t)}),delete e.targetFull,e.query!==a&&(e.targetFull=a)},e}();var w=function(){function e(e,t,r,a){this.$q=t,this.backendSrv=r,this.templateSrv=a,this.type="irondb",this.name=e.name,this.id=e.id,this.accountId=(e.jsonData||{}).accountId,this.irondbType=(e.jsonData||{}).irondbType,this.resultsLimit=(e.jsonData||{}).resultsLimit,this.apiToken=(e.jsonData||{}).apiToken,this.url=e.url,this.supportAnnotations=!1,this.supportMetrics=!0,this.appName="Grafana"}return e.$inject=["instanceSettings","$q","backendSrv","templateSrv"],e.prototype.query=function(e){var t=this;e.scopedVars;return n.a.isEmpty(e.targets[0])?this.$q.when({data:[]}):Promise.all([this._buildIrondbParams(e)]).then(function(e){return n.a.isEmpty(e[0])?t.$q.when({data:[]}):t._irondbRequest(e[0])}).then(function(e){return e.data.constructor===Array&&e.data.sort(function(e,t){return e.target.localeCompare(t.target)}),e}).catch(function(e){(0!==e.status||e.status>=300)&&t._throwerr(e)})},e.prototype.annotationQuery=function(e){throw new Error("Annotation Support not implemented yet.")},e.prototype.metricFindQuery=function(e,t){var r=t.variable;if(""!==e&&void 0!==r){var a=e,o=r.tagValuesQuery;if(r.useTags&&""!==o)return this.metricTagValsQuery(a,o).then(function(e){return n.a.map(e.data,function(e){return{value:e}})})}return Promise.resolve([])},e.prototype.getAccountId=function(){return"standalone"===this.irondbType?"/"+this.accountId:""},e.prototype.metricTagsQuery=function(e,t){if(void 0===t&&(t=!1),""===e||void 0===e||!t&&"and(__name:*)"===e)return Promise.resolve({data:[]});var r="/find"+this.getAccountId()+"/tags?query=";return r+=e,this._irondbSimpleRequest("GET",r,!1,!0)},e.prototype.metricTagCatsQuery=function(e){var t="/find"+this.getAccountId()+"/tag_cats?query=";return t=t+"and(__name:"+e+")",this._irondbSimpleRequest("GET",t,!1,!0,!1)},e.prototype.metricTagValsQuery=function(e,t){var r="/find"+this.getAccountId()+"/tag_vals?category="+t+"&query=";return r=r+"and(__name:"+e+")",this._irondbSimpleRequest("GET",r,!1,!0,!1)},e.prototype.testDatasource=function(){return this.metricTagsQuery("and(__name:ametric)").then(function(e){var t=n.a.get(e,"results[0].error");return t?{status:"error",message:t,title:"Error"}:{status:"success",message:"Data source is working",title:"Success"}}).catch(function(e){var t=(e.data||{}).message;return void 0===t&&(t="Error "+(e.status||"")+" "+(e.statusText||"")),{status:"error",message:t,title:"Error"}})},e.prototype._throwerr=function(e){if(e.data&&e.data.error)throw new Error("Circonus IRONdb Error: "+e.data.error);if(e.data&&e.data.user_error){var t=e.data.method||"IRONdb",r="";throw e.data.user_error.query&&(r=' in"'+e.data.user_error.query+'"'),new Error(t+" error: "+e.data.user_error.message+r)}throw"Not Found"===e.statusText?new Error("Circonus IRONdb Error: "+e.statusText):e.statusText&&e.status>0?new Error("Network Error: "+e.statusText+"("+e.status+")"):new Error("Error: "+(e?e.toString():"unknown"))},e.prototype._irondbSimpleRequest=function(e,t,r,a,n){void 0===r&&(r=!1),void 0===a&&(a=!1),void 0===n&&(n=!0);var o=this.url,i={"Content-Type":"application/json"};"hosted"!=this.irondbType&&(i["X-Circonus-Account"]=this.accountId),"hosted"!=this.irondbType||r||(o+="/irondb",a||(o+="/series_multi"),i["X-Circonus-Auth-Token"]=this.apiToken,i["X-Circonus-App-Name"]=this.appName),i["X-Snowth-Advisory-Limit"]=n?this.resultsLimit:"none","standalone"!=this.irondbType||r||a||(o+="/series_multi"),r&&!a&&(o+="/extension/lua/caql_v1");var s={method:e,url:o+t,headers:i,retry:1};return this.backendSrv.datasourceRequest(s)},e.prototype._irondbRequest=function(e,t,r){var a=this;void 0===t&&(t=!1),void 0===r&&(r=!0);var n={"Content-Type":"application/json"},o={},i=[],s={data:[]};if("hosted"==this.irondbType?(n["X-Circonus-Auth-Token"]=this.apiToken,n["X-Circonus-App-Name"]=this.appName):n["X-Circonus-Account"]=this.accountId,n["X-Snowth-Advisory-Limit"]=r?this.resultsLimit:"none",n.Accept="application/json",e.std.names.length){var u=e.std.names[0].leaf_data.paneltype||"Graph";(o={}).url=this.url,"hosted"===this.irondbType&&(o.url=o.url+"/irondb",o.url=o.url+"/fetch"),o.method="POST","standalone"===this.irondbType&&(o.url=o.url+"/fetch");var l=[],d=e.std.interval,p=e.std.start,c=e.std.end;p=Math.floor(p-p%d),c=Math.floor(c-c%d);var g="Heatmap"===u?"merge":"pass",f=[],h={streams:f};h.period=d,h.start=p,h.count=Math.round((c-p)/d),h.reduce=[{label:"",method:g}];for(var m=0;m<e.std.names.length;m++){var v="Heatmap"===u?"histogram":"numeric";l.push(e.std.names[m].leaf_data.metriclabel);var y={},b=e.std.names[m].leaf_data.egress_function;b="Heatmap"===u?"none":b,y.transform=b,y.name=e.std.names[m].leaf_name,y.uuid=e.std.names[m].leaf_data.uuid,y.kind=v,f.push(y)}o.data=h,o.name="fetch",o.headers=n,(this.basicAuth||this.withCredentials)&&(o.withCredentials=!0),this.basicAuth&&(o.headers.Authorization=this.basicAuth),o.metricLabels=l,o.paneltype=u,o.isCaql=!1,o.retry=1,i.push(o)}if(e.caql.names.length)for(m=0;m<e.caql.names.length;m++){(o={}).url=this.url,"hosted"==this.irondbType&&(o.url=o.url+"/irondb"),o.method="GET",o.url=o.url+"/extension/lua","hosted"==this.irondbType&&(o.url=o.url+"/public");var A=this.templateSrv.replace(e.caql.names[m]);o.url=o.url+"/caql_v1?format=DF4&start="+e.caql.start,o.url=o.url+"&end="+e.caql.end,o.url=o.url+"&period="+e.caql.interval,o.url=o.url+"&q="+encodeURIComponent(A),o.name=e.caql.names[m],o.headers=n,o.start=e.caql.start,o.end=e.caql.end,o.retry=1,(this.basicAuth||this.withCredentials)&&(o.withCredentials=!0),this.basicAuth&&(o.headers.Authorization=this.basicAuth),o.isCaql=!0,i.push(o)}return Promise.all(i.map(function(e){return a.backendSrv.datasourceRequest(e).then(function(t){return a._convertIrondbDf4DataToGrafana(t,e)}).then(function(e){if(e.data.constructor===Array)for(var t=0;t<e.data.length;t++)s.data.push(e.data[t]);return e.data.constructor===Object&&s.data.push(e.data),s})})).then(function(e){return s}).catch(function(e){(0!==e.status||e.status>=300)&&a._throwerr(e)})},e.prototype._buildIrondbParamsAsync=function(e){var t,r,a=this,o={},i=!1,s=new Date(e.range.from).getTime()/1e3,u=new Date(e.range.to).getTime()/1e3,l=Math.floor(1e3*(u-s)/e.intervalMs);l>e.maxDataPoints/2&&(l=e.maxDataPoints/2);var d=Math.ceil((u-s)/l),p=[86400,3600,1800,1200,900,300,60,30,15,10,5,1];for(var c in p)if(d>1e3*p[c]){d=Math.floor(d/(1e3*p[c]))*(1e3*p[c]);break}for(d<60?d=60:d-=d%60,o.std={},o.std.start=s,o.std.end=u,o.std.names=[],o.std.interval=d,o.caql={},o.caql.start=s,o.caql.end=u,o.caql.names=[],o.caql.interval=d,t=0;t<e.targets.length;t++)(r=e.targets[t]).hide||(i=!0,!r.isCaql&&r.query&&(r.query.includes("*")||r.query.includes("?")||r.query.includes("[")||r.query.includes("]")||r.query.includes("(")||r.query.includes(")")||r.query.includes("{")||r.query.includes("}")||r.query.includes(";"))&&!0);if(!i)return{};for(t=0;t<e.targets.length;t++)!(r=e.targets[t]).hide&&r.query&&0!=r.query.length&&r.isCaql&&o.caql.names.push(r.query);if(r.isCaql)return o;var g=e.targets.map(function(e){var t=a.templateSrv.replace(e.query);return a.metricTagsQuery(t).then(function(t){var r="numeric";"Heatmap"===e.paneltype&&(r="histogram"),t.data=n.a.filter(t.data,function(e){var t=e.type.split(",");return n.a.includes(t,r)});for(var a=0;a<t.data.length;a++)t.data[a].target=e;return t.data}).then(function(t){for(var r=0;r<t.length;r++)if(!t[r].target.hide&&!e.isCaql){t[r].leaf_data={egress_function:"average",uuid:t[r].uuid,paneltype:t[r].target.paneltype},"average"!==e.egressoverride&&(t[r].leaf_data.egress_function=e.egressoverride);var n=t[r].metric_name;if("default"!==e.labeltype){var i=e.metriclabel;"name"===e.labeltype?i="%n":"cardinality"===e.labeltype&&(i="%n | %t-{*}"),i=f(i,t,r),i=a.templateSrv.replace(i),t[r].leaf_data.metriclabel=i}o.std.names.push({leaf_name:n,leaf_data:t[r].leaf_data})}return o})});return Promise.all(g).then(function(e){return o}).catch(function(e){0!==e.status||e.status})},e.prototype._buildIrondbParams=function(e){var t=this;return new Promise(function(r,a){r(t._buildIrondbParamsAsync(e))})},e.prototype._convertIrondbDf4DataToGrafana=function(e,t){var r=t.name,a=e.data.data,o=e.data.meta,i=[],s=e.data.head.start,u=e.data.head.count,l=e.data.head.period;if(!a||0==a.length)return{data:i};for(var d={},p=0;p<a.length;p++){var c=r+" ["+(p+1)+"]",g=o[p]?o[p].label:c,f=t.metricLabels[p];n.a.isString(f)&&(g=f);for(var h=0;h<a[p].length;h++)if(null!=a[p][h]){var m=1e3*(s+h*l);if(!(m<1e3*t.start))if(a[p][h].constructor===Number)void 0===i[p]&&(i[p]={target:g,datapoints:[]}),i[p].datapoints.push([a[p][h],m]);else if(a[p][h].constructor===Object)for(var v in a[p][h]){u=a[p][h][v];v=parseFloat(v).toString();var y=m.toString();null==d[v]&&(d[v]={target:v,datapoints:[],_ts:{}},i.push(d[v])),null==d[v]._ts[y]?(d[v]._ts[y]=[u,m],d[v].datapoints.push(d[v]._ts[y])):d[v]._ts[y][0]+=u}}}for(h=0;h<i.length;h++)delete i[h]._ts;return{data:i}},e}(),E=r(1);r(2);var C=function(e){function t(t,r,a,o){var i=e.call(this,t,r)||this;return i.uiSegmentSrv=a,i.templateSrv=o,i.defaults={},i.labelTypeOptions=[{value:"default",text:"name and tags"},{value:"name",text:"name only"},{value:"cardinality",text:"high cardinality tags"},{value:"custom",text:"custom"}],i.egressTypeOptions=[{value:"count",text:"number of data points (count)"},{value:"average",text:"average value (gauge)"},{value:"average_stddev",text:"standard deviation a.k.a. σ (stddev)"},{value:"derive",text:"rate of change (derive)"},{value:"derive_stddev",text:"rate of change σ (derive_stddev)"},{value:"counter",text:"rate of positive change (counter)"},{value:"counter_stddev",text:"rate of positive change σ (counter_stddev)"}],i.caqlFindFunctions={count:"count",average:"average",average_stddev:"stddev",derive:"derivative",derive_stddev:"derivative_stddev",counter:"counter",counter_stddev:"counter_stddev"},n.a.defaultsDeep(i.target,i.defaults),i.target.isCaql=i.target.isCaql||!1,i.target.egressoverride=i.target.egressoverride||"average",i.target.metriclabel=i.target.metriclabel||"",i.target.labeltype=i.target.labeltype||"default",i.target.query=i.target.query||"",i.target.segments=i.target.segments||[],i.target.paneltype=i.panelCtrl.pluginName,i.queryModel=new S(i.datasource,i.target,o),i.buildSegments(),i.updateMetricLabelValue(!1),i}return t.$inject=["$scope","$injector","uiSegmentSrv","templateSrv"],function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t.prototype.toggleEditorMode=function(){this.target.isCaql=!this.target.isCaql,this.typeValueChanged()},t.prototype.typeValueChanged=function(){if(this.target.isCaql){var e=this.segmentsToCaqlFind();this.target.query=e}else this.target.query="",this.target.egressoverride="average",this.target.labeltype="default",this.emptySegments(),this.parseTarget();this.error=null,this.panelCtrl.refresh()},t.prototype.labelTypeValueChanged=function(){"custom"===this.target.labeltype&&setTimeout(function(){document.getElementById("metriclabel").focus()},50),this.panelCtrl.refresh()},t.prototype.metricLabelKeyUp=function(e){var t=this,r=e.currentTarget;13===e.keyCode&&setTimeout(function(){t.target.metriclabel=r.value,t.updateMetricLabelValue()},0)},t.prototype.updateMetricLabelValue=function(e){void 0===e&&(e=!0),""===this.target.metriclabel&&"custom"===this.target.labeltype&&(this.target.labeltype="default"),e&&this.panelCtrl.refresh()},t.prototype.egressValueChanged=function(){this.panelCtrl.refresh()},t.prototype.onChangeInternal=function(){this.panelCtrl.refresh()},t.prototype.getCollapsedText=function(){return this.target.query},t.prototype.getSegments=function(e,t){var r=this,a=t&&t.length>0?t:"",o=this.segments[e]._type;if(o===i.MetricName)return A(i.MetricName,a)!==a?a="b/"+btoa(this.escapeRegExp(a))+"/":a+="*",this.datasource.metricTagsQuery("and(__name:"+a+")",!0).then(function(t){var a=n.a.map(t.data,function(e){return p(e.metric_name)});a=n.a.uniq(a);var o=n.a.map(a,function(e){return r.newSegment(i.MetricName,{value:e,expandable:!0})});return 0===e&&n.a.eachRight(r.panelCtrl.panel.targets,function(e){e.refId,r.queryModel.target.refId}),o}).catch(function(e){return[]});if(o===i.TagCat||o===i.TagPlus){var u=A(i.MetricName,this.segments[0].value);return this.datasource.metricTagCatsQuery(u).then(function(e){var t,a;if(e.data&&e.data.length>0){var n=e.data,u=[];try{for(var l=s(n),d=l.next();!d.done;d=l.next()){var p=d.value;u.push(r.newSegment(i.TagCat,{value:T(p),expandable:!0}))}}catch(e){t={error:e}}finally{try{d&&!d.done&&(a=l.return)&&a.call(l)}finally{if(t)throw t.error}}return o===i.TagPlus&&(u.unshift(r.newSegment(i.TagOp,{value:"and("})),u.unshift(r.newSegment(i.TagOp,{value:"not("})),u.unshift(r.newSegment(i.TagOp,{value:"or("}))),u}}).catch(function(e){return[]})}if(o===i.TagOp){var l=[this.newSegment(i.TagOp,{value:"REMOVE"}),this.newSegment(i.TagOp,{value:"and("}),this.newSegment(i.TagOp,{value:"not("}),this.newSegment(i.TagOp,{value:"or("})];return Promise.resolve(l)}if(o===i.TagVal){u=A(i.MetricName,this.segments[0].value);var d=this.segments[e-2].value;return"select tag"===d?Promise.resolve([]):this.datasource.metricTagValsQuery(u,A(i.TagCat,d,!1)).then(function(e){var t,a;if(e.data&&e.data.length>0){var o=e.data,u=[];u.push(r.newSegment(i.TagVal,{value:"*",expandable:!0})),n.a.eachRight(r.templateSrv.variables,function(e){u.push(r.newSegment(i.TagVal,{type:"template",value:"$"+e.name,expandable:!0}))});try{for(var l=s(o),d=l.next();!d.done;d=l.next()){var p=d.value;u.push(r.newSegment(i.TagVal,{value:T(p),expandable:!0}))}}catch(e){t={error:e}}finally{try{d&&!d.done&&(a=l.return)&&a.call(l)}finally{if(t)throw t.error}}return u}}).catch(function(e){return[]})}return Promise.resolve([])},t.prototype.parseTarget=function(){this.queryModel.parseTarget(),this.buildSegments()},t.prototype.setSegmentType=function(e,t){return e._type=t,e._typeName=i[t],e},t.prototype.newSegment=function(e,t){var r=this.uiSegmentSrv.newSegment(t);return this.setSegmentType(r,e)},t.prototype.mapSegment=function(e){var t;return t=e.type===i.TagOp?this.uiSegmentSrv.newOperator(e.value):e.type===i.TagEnd?this.uiSegmentSrv.newOperator(")"):e.type===i.TagPair?this.uiSegmentSrv.newCondition(":"):e.type===i.TagSep?this.uiSegmentSrv.newCondition(","):e.type===i.TagPlus?this.buildSelectTagPlusSegment():this.uiSegmentSrv.newSegment(e),this.setSegmentType(t,e.type)},t.prototype.buildSegments=function(){var e=this;this.segments=n.a.map(this.queryModel.segments,function(t){return e.mapSegment(t)});var t=this.queryModel.checkOtherSegmentsIndex||0;this.checkOtherSegments(t)},t.prototype.addSelectMetricSegment=function(){this.queryModel.addSelectMetricSegment();var e=this.uiSegmentSrv.newSelectMetric();this.setSegmentType(e,i.MetricName),this.segments.push(e)},t.prototype.buildSelectTagPlusSegment=function(){var e=this.uiSegmentSrv.newPlusButton();return this.setSegmentType(e,i.TagPlus),e},t.prototype.addSelectTagPlusSegment=function(){this.segments.push(this.buildSelectTagPlusSegment())},t.prototype.newSelectTagValSegment=function(){var e=this.uiSegmentSrv.newKeyValue("*");return this.setSegmentType(e,i.TagVal),e},t.prototype.checkOtherSegments=function(e){e===this.segments.length&&(this.segments[e-1]._type===i.MetricName&&this.addSelectTagPlusSegment());return Promise.resolve()},t.prototype.setSegmentFocus=function(e){n.a.each(this.segments,function(t,r){t.focus=e===r})},t.prototype.segmentValueChanged=function(e,t){var r=this;if(this.error=null,this.queryModel.updateSegmentValue(e,t),e._type!==i.TagOp){if(e._type===i.TagPlus){if("and("===e.value||"not("===e.value||"or("===e.value)return this.segments.splice(t,1),t>2&&this.segments.splice(t,0,this.mapSegment({type:i.TagSep})),this.segments.splice(t+1,0,this.mapSegment({type:i.TagOp,value:e.value}),this.mapSegment({type:i.TagCat,value:"select tag",fake:!0}),this.mapSegment({type:i.TagPair}),this.newSelectTagValSegment(),this.buildSelectTagPlusSegment(),this.mapSegment({type:i.TagEnd})),t>2&&this.segments.splice(t+7,0,this.buildSelectTagPlusSegment()),void this.setSegmentFocus(t+3);this.segments.splice(t,1),t>2&&this.segments.splice(t,0,this.mapSegment({type:i.TagSep})),this.segments.splice(t+1,0,this.mapSegment({type:i.TagCat,value:e.value}),this.mapSegment({type:i.TagPair}),this.newSelectTagValSegment(),this.buildSelectTagPlusSegment()),1==t&&(this.segments.splice(t,0,this.mapSegment({type:i.TagOp,value:"and("})),this.segments.push(this.mapSegment({type:i.TagEnd})))}if(0==t&&this.spliceSegments(t+1),e.expandable)return this.checkOtherSegments(t+1).then(function(){r.setSegmentFocus(t+1),r.targetChanged()});this.setSegmentFocus(t+1),this.targetChanged()}else{if("REMOVE"===e.value){for(var a=t+1,n=1,o=this.segments.length;n>0&&a<o;){var s=this.segments[a]._type;if(s===i.TagOp)n++;else if(s===i.TagEnd&&0==--n)break;a++}var u=t,l=a-t+1;t>2&&(u--,l++),this.segments.splice(u,l),o===a+1&&this.segments.push(this.buildSelectTagPlusSegment())}this.targetChanged()}},t.prototype.spliceSegments=function(e){this.segments=this.segments.splice(0,e),this.queryModel.segments=this.queryModel.segments.splice(0,e)},t.prototype.emptySegments=function(){this.queryModel.segments=[],this.segments=[]},t.prototype.segmentsToStreamTags=function(){var e,t,r=this.segments.slice(),a=r.shift().value,n="and(__name:"+A(i.MetricName,a),o=!1;try{for(var u=s(r),l=u.next();!l.done;l=u.next()){var d=l.value,p=d._type;p!==i.TagPlus&&(o||p===i.TagEnd||p===i.TagSep||(n+=","),o=p===i.TagOp||p===i.TagPair||p===i.TagCat||p===i.TagSep,n+=A(p,d.value))}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}return n+=")"},t.prototype.queryFunctionToCaqlFind=function(){if("Heatmap"===this.target.paneltype)return"find:histogram";var e="find",t=this.target.egressoverride;return"average"!==t&&(e+=":"+(t=this.caqlFindFunctions[t])),e},t.prototype.buildCaqlLabel=function(){var e=this.target.labeltype,t=this.target.metriclabel;if("default"!==e){if("custom"===e&&""!==t)return" | label('"+(t=t.replace(/'/g,'"'))+"')";if("name"===e)return" | label('%n')";if("cardinality"===e)return" | label('%n | %t-{*}')"}return" | label('%cn')"},t.prototype.segmentsToCaqlFind=function(){var e,t,r=this.segments.slice(),a=r.shift().value,n=1===r.length&&r[0]._type==i.TagPlus;if("*"===a&&n)return"";var o=this.queryFunctionToCaqlFind()+"('"+a+"'";if(n)return o+=")"+this.buildCaqlLabel();var u=!0,l=!1;try{for(var d=s(r),p=d.next();!p.done;p=d.next()){var c=p.value,g=c._type;g!==i.TagPlus&&(l||g===i.TagEnd||g===i.TagSep||(o+=",",u&&(o+=" '",u=!1)),l=g===i.TagOp||g===i.TagPair||g===i.TagCat||g===i.TagSep,o+=A(g,c.value))}}catch(t){e={error:t}}finally{try{p&&!p.done&&(t=d.return)&&t.call(d)}finally{if(e)throw e.error}}return o+="')"+this.buildCaqlLabel()},t.prototype.updateModelTarget=function(){var e=this.segmentsToStreamTags();this.queryModel.updateModelTarget(this.panelCtrl.panel.targets),this.queryModel.target.query=e},t.prototype.targetChanged=function(){if(!this.queryModel.error){var e=this.queryModel.target.query;this.updateModelTarget(),this.queryModel.target!==e&&this.panelCtrl.refresh()}},t.prototype.showDelimiter=function(e){return e!==this.segments.length-1},t.prototype.escapeRegExp=function(e){return String(e).replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")},t.templateUrl="partials/query.editor.html",t}(E.QueryCtrl);var q=function(){function e(e){this.current.jsonData.irondbType=this.current.jsonData.irondbType||"standalone",this.current.jsonData.resultsLimit=this.current.jsonData.resultsLimit||"100"}return e.templateUrl="partials/config.html",e}();r.d(t,"AnnotationsQueryCtrl",function(){return _}),r.d(t,"Datasource",function(){return w}),r.d(t,"QueryCtrl",function(){return C}),r.d(t,"ConfigCtrl",function(){return q});var _=function(){function e(){}return e.templateUrl="partials/annotations.editor.html",e}()}])});